<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-CanaanK230/part3/K230USBapplicationisUVCtransmissionofYUVandcodedstreams" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.5.2">
<title data-rh="true">K230 USB应用实战-UVC传输YUV及编码码流 | 正点原子</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://tm330075395.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://tm330075395.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://tm330075395.github.io/docs/CanaanK230/part3/K230USBapplicationisUVCtransmissionofYUVandcodedstreams"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="K230 USB应用实战-UVC传输YUV及编码码流 | 正点原子"><meta data-rh="true" name="description" content="概述"><meta data-rh="true" property="og:description" content="概述"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://tm330075395.github.io/docs/CanaanK230/part3/K230USBapplicationisUVCtransmissionofYUVandcodedstreams"><link data-rh="true" rel="alternate" href="https://tm330075395.github.io/docs/CanaanK230/part3/K230USBapplicationisUVCtransmissionofYUVandcodedstreams" hreflang="en"><link data-rh="true" rel="alternate" href="https://tm330075395.github.io/docs/CanaanK230/part3/K230USBapplicationisUVCtransmissionofYUVandcodedstreams" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="正点原子 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="正点原子 Atom Feed"><link rel="stylesheet" href="/assets/css/styles.ce37c9a8.css">
<script src="/assets/js/runtime~main.fcaa3de9.js" defer="defer"></script>
<script src="/assets/js/main.252b8acf.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">My Site</b></a><a class="navbar__item navbar__link" href="/docs/intro">Tutorial</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/CanaanK230/Userdoc">CanMV-K230教程</a><a href="http://www.alientek.com" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">正点原子官网<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="http://www.openedv.com/forum.php" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">论坛<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/tm330075395/tm330075395.github.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/CanaanK230/Userdoc">文档阅读指南</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/1开发板上手指南-1">1.开发板上手指南</a><button aria-label="Expand sidebar category &#x27;1.开发板上手指南&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/2开发环境搭建指南-1">2.开发环境搭建指南</a><button aria-label="Expand sidebar category &#x27;2.开发环境搭建指南&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/docs/category/3嵌入式应用开发指南-1">3.嵌入式应用开发指南</a><button aria-label="Collapse sidebar category &#x27;3.嵌入式应用开发指南&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/CanaanK230/part3/K230PracticalBasics-hello world">K230 实战基础篇 - hello world</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/CanaanK230/part3/K230AIActualcombatHHBNeuralNetworkModelDeploymentTool">K230 AI实战 - HHB神经网络模型部署工具</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/CanaanK230/part3/K230GPUPracticalapplication-VGLitedrawscoolgraphics">K230 GPU 应用实战 - VGLite 绘制酷炫图形</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/CanaanK230/part3/K230GUIpractical LVGLportingtutorials">K230 GUI实战 - LVGL移植教程</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/CanaanK230/part3/K230RVVActualcombat">K230 RVV实战</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/CanaanK230/part3/K230USBapplicationisUVCtransmissionofYUVandcodedstreams">K230 USB应用实战-UVC传输YUV及编码码流</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/CanaanK230/part3/K230imagepracticebootvideoandbootlogo">K230 图像实战 - 开机视频和开机logo</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/CanaanK230/part3/K230codingpracticertspserverbuildandpushstreams">K230 编码实战 - rtsp sever搭建和推流</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/CanaanK230/part3/K230audiopracticeaudiocollectionplaybackandencoding">K230 音频实战 - 音频采集、播放和编解码</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/CanaanK230/part3/K230SceneCombatSmartDoorLockPOC">K230 场景实战-智能门锁POC</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/CanaanK230/part3/K230SceneCombatSmartDoorLockPOC3DStructuredLight">K230 场景实战-智能门锁POC</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/CanaanK230/part3/K230SceneCombatMaoyanPOC">K230 场景实战-猫眼POC</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/CanaanK230/part3/K230SceneCombatDictionaryPenPOC">K230 场景实战-词典笔POC</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/CanaanK230/part3/K230SceneCombatdpuDepthCameraPOC">K230 场景实战-dpu深度相机POC</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/CanaanK230/part3/K230AIDemointroduce">K230 AI Demo介绍</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/CanaanK230/part3/K230FancyPOCintroduce">K230 Fancy POC介绍</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/CanaanK230/part3/K230SDKCanMVBoardDemoDirectionsforuse">K230 SDK CanMV Board Demo使用指南</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/CanaanK230/part3/K230SDKEVBBoardDemoDirectionsforuse">K230 SDK EVB Board Demo使用指南</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/4ai应用开发指南-1">4.AI应用开发指南</a><button aria-label="Expand sidebar category &#x27;4.AI应用开发指南&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/5micropython应用开发指南-1">5.MicroPython应用开发指南</a><button aria-label="Expand sidebar category &#x27;5.MicroPython应用开发指南&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/6系统开发指南-1">6.系统开发指南</a><button aria-label="Expand sidebar category &#x27;6.系统开发指南&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/7sdk-api参考指南-1">7.SDK API参考指南</a><button aria-label="Expand sidebar category &#x27;7.SDK API参考指南&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/8常见问题-1">8.常见问题</a><button aria-label="Expand sidebar category &#x27;8.常见问题&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/3嵌入式应用开发指南-1"><span itemprop="name">3.嵌入式应用开发指南</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">K230 USB应用实战-UVC传输YUV及编码码流</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>K230 USB应用实战-UVC传输YUV及编码码流</h1></header>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="概述">概述<a href="#概述" class="hash-link" aria-label="Direct link to 概述" title="Direct link to 概述">​</a></h2>
<p>本文将讲解如何在k230开发板上实现USB摄像头功能。也就是把K230 开发板连接到电脑，电脑可以通过播放器播放K230摄像头采集到的图像。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="1-环境准备">1. 环境准备<a href="#1-环境准备" class="hash-link" aria-label="Direct link to 1. 环境准备" title="Direct link to 1. 环境准备">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="11-硬件环境">1.1 硬件环境<a href="#11-硬件环境" class="hash-link" aria-label="Direct link to 1.1 硬件环境" title="Direct link to 1.1 硬件环境">​</a></h3>
<ul>
<li>K230-UNSIP-LP3-EVB-V1.0/K230-UNSIP-LP3-EVB-V1.1</li>
<li>Ubuntu PC 20.04</li>
<li>Typec USB线 * 1 至少</li>
<li>USB TypeC转以太网(如果使用TFTP加载和NFS文件系统)</li>
<li>网线一根</li>
<li>SD卡(如果使用SD卡启动，或软件需要访问SD卡)</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="12-软件环境">1.2 软件环境<a href="#12-软件环境" class="hash-link" aria-label="Direct link to 1.2 软件环境" title="Direct link to 1.2 软件环境">​</a></h3>
<p>k230_sdk中提供了工具链，分别在如下路径。</p>
<ul>
<li>大核rt-samrt工具链</li>
</ul>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">k230_sdk/toolchain/riscv64-linux-musleabi_for_x86_64-pc-linux-gnu</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>小核linux工具链</li>
</ul>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">k230_sdk/toolchain/Xuantie-900-gcc-linux-5.10.4-glibc-x86_64-V2.6.0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>也可通过以下链接下载工具链</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">wget https://download.rt-thread.org/rt-smart/riscv64/riscv64-unknown-linux-musl-rv64imafdcv-lp64d-20230222.tar.bz2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wget https://occ-oss-prod.oss-cn-hangzhou.aliyuncs.com/resource//1659325511536/Xuantie-900-gcc-linux-5.10.4-glibc-x86_64-V2.6.0-20220715.tar.gz</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="2-sdk-uvc-demo体验">2. SDK UVC demo体验<a href="#2-sdk-uvc-demo体验" class="hash-link" aria-label="Direct link to 2. SDK UVC demo体验" title="Direct link to 2. SDK UVC demo体验">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="21-release-sdk编译固件烧录固件">2.1 release sdk编译固件，烧录固件<a href="#21-release-sdk编译固件烧录固件" class="hash-link" aria-label="Direct link to 2.1 release sdk编译固件，烧录固件" title="Direct link to 2.1 release sdk编译固件，烧录固件">​</a></h3>
<p>参考 《环境搭建》和《开发板上手使用》章节描述</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="22-执行命令测试demo">2.2 执行命令测试demo<a href="#22-执行命令测试demo" class="hash-link" aria-label="Direct link to 2.2 执行命令测试demo" title="Direct link to 2.2 执行命令测试demo">​</a></h3>
<p>参考 《K230_SDK_Demo使用指南》 2.9 UVC_demo 章节</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="3-如何开发uvc功能">3. 如何开发UVC功能<a href="#3-如何开发uvc功能" class="hash-link" aria-label="Direct link to 3. 如何开发UVC功能" title="Direct link to 3. 如何开发UVC功能">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="31-usbuvc协议">3.1 USB/UVC协议<a href="#31-usbuvc协议" class="hash-link" aria-label="Direct link to 3.1 USB/UVC协议" title="Direct link to 3.1 USB/UVC协议">​</a></h3>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="311-usb协议">3.1.1 USB协议<a href="#311-usb协议" class="hash-link" aria-label="Direct link to 3.1.1 USB协议" title="Direct link to 3.1.1 USB协议">​</a></h3>
<p>USB协议内容比较多，是用得非常普遍的接口，互联网上资料很多。本文只描述一些我认为有助于对USB协议理解的点。</p>
<p>USB2.0有4条线，VBUS/GND/D+/D-，差分信号传输。低速/全速使用3.3V电压，高速使用400mV电压。除了传递数据的差分0/1信号外，其他的一些电压组合可以用来作为速度识别，空闲、复位、唤醒等信号。</p>
<p>PHY可以理解为做一个并转串的操作，把UTMI+信号转成D+/D-的差分信号。</p>
<p><img decoding="async" loading="lazy" alt="usb_phy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkMAAACaCAYAAACql0xVAAAgAElEQVR4nO3de1yT99038E+EWiMOCU4LaGk1Ip0VRfcYoQcsbK0dtnaKRauzdg+g4gm9mwmC4AFB8EnnWVSwB5lWqIFaK6trBy1awbgqine3CLn10RZRBwGnhjow9x9KRgTkIOFKcn3erxevNleuK9cXOX3yO0qMRqMRRERERCLVQ+gCiIiIiITEMERERESixjBEREREosYwRERERKLGMERERESixjBEREREosYwRERERKLm2NYJBz/7rDvqoHZ6Y9IkoUsgIiKyK22Gof1ZWd1RB7UTwxAREVHXajMMNQqZMsWSdVAb1Dk5QpdARERkl9odhqaGhFiyDmoDwxAREZFlcAA1ERERiRrDEBEREYkawxARERGJGsMQERERiRrDEBEREYkawxARERGJGsMQERERiRrDEBEREYkawxARERGJGsMQERERiRrDEBEREYkawxARERGJGsMQERERiRrDEBEREYkawxARERGJGsMQERERiRrDEBEREYmao9AFkH3I/fRToUsgGzb5t78VugQiEjGGIeoS2Z98InQJZMMYhohISAxD1KVCpkwRugSyIeqcHKFLICKy/TCkUqmQnp5uehwREQGlUgmdTofw8HBUVFSYnktOTkZISAgAQKPRIDs7G4mJiZBKpaZzdDodUlNTkZqaCplM1n2fSBczGo04d+4cnn32WfTo0X1Dw6be//clag+GIWqv3739ttAldLk/7dkjdAl0n82GIb1ej7lz50KhUECr1ZqOZ2ZmQq/XAwC8vLyQk5MDmUxmOh+AKRDZo8qrV/H111/j6NGjcHNzg4+Pj9AlERE9soaGBqFLIDtmk2HIYDAgKSkJ06ZNaxZsZs2aBQCorq42Oy6TyaBUKlFYWNhtdXaX27dv4+ixYzh67Bh0Op3p+BR2WRGRnfl4716hS3hkb82cKXQJ9ACbDEMVFRW4ceMGgoKCOnTd5cuXLVRR92toaMCZs2dRWFiIv333XYvvmuRDhghQGRERkW2xyTBUVVUFZ2dn9OrVq93X6PV6ZGVlQalUWrAyy+vIO4rlcXEPfd6pd29kNBlvRUREJEY2GYbaq6ysDH5+fqbHmZmZUCgUAlZkXW7dvi10CUQ26datW3BychK6jE6x5dqJLMUmw1C/fv1w48YN1NXV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" width="579" height="154" class="img_ev3q"></p>
<p>理论上两条数据信号完全可以使用gpio来进行控制，只是协议太复杂，且gpio的变化速度太慢。无论是SPI/SDIO/UART/IIC等等这些接口控制器都是这样，控制器尽可能提供给软件必要的接口，且让软件做尽可能少的操作。USB控制器也就是把协议的功能尽可能让硬件来做，比如速度协商，收到数据包后自动产生应答包等等功能。提供一些寄存器接口告知软件当前USB通信的状态。当然最重要的是提供传输数据的接口，让软件可以收发不同的数据，收发数据一般都会使用DMA。</p>
<p>USB传输数据是以包为基本单位的。下图为包的构成</p>
<p><img decoding="async" loading="lazy" alt="packet" src="/assets/images/usb_packet-ecd67d9539e105cf5da18a412eacf4ba.png" width="622" height="123" class="img_ev3q"></p>
<p>PID决定了包的类型，令牌包、数据包、握手包和特殊包，不同的包类型包含的字段成分不一样，比如数据包只包含PID+数据+CRC，握手包只有PID。</p>
<p>包组成了事务，令牌包+数据包(可选)+握手包(可选)。下图使用南京沁恒出的USB2.0高速总线分析仪捕获的USB交互信息，如果想捕获USB线上的数据比较推荐这款仪器。</p>
<p><img decoding="async" loading="lazy" alt="transaction" src="/assets/images/usb_transaction-b882fffff8d390ebe28f17d9802d1cdf.png" width="1420" height="526" class="img_ev3q"></p>
<p>可以看到前面是枚举传输，包含SETUP事务，数据IN/OUT事务，状态IN/OUT事务。后面是同步传输，包含数据IN事务。</p>
<p>传输是由单次或多次事务组成，有4种传输类型：</p>
<p>控制传输-在枚举阶段使用，所有的USB设备连接主机时，都需要一套统一的协议去识别各种USB设备类型。USB控制器初始阶段会让0端点为双向控制端点。</p>
<p><img decoding="async" loading="lazy" alt="control" src="/assets/images/usb_control-f079a11d4e05f9eedf0669dec0652dd7.png" width="323" height="443" class="img_ev3q"></p>
<p>中断传输-小数据量和不连续，且实时性要求高的场合。比如鼠标键盘。</p>
<p><img decoding="async" loading="lazy" alt="interrupt" src="/assets/images/usb_interrupt-dd76024ae6f4ded3190554c1f1a336f3.png" width="601" height="428" class="img_ev3q"></p>
<p>同步传输-数据量大、连续，且要求实时性的场合。比如USB摄像头设备。</p>
<p><img decoding="async" loading="lazy" alt="iso" src="data:image/png;base64,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" width="361" height="338" class="img_ev3q"></p>
<p>批量传输-用于数据量大，但没有实时性要求的场合。比如U盘设备。</p>
<p><img decoding="async" loading="lazy" alt="bulk" src="/assets/images/usb_bulk-0eff358ca88ec4a407df74f2658c0fe0.png" width="665" height="350" class="img_ev3q"></p>
<p>无论是什么样的USB设备协议，都是通过这4种传输来实现的。所以像linux这样的操作系统的USB协议栈，提供了这4种传输方式的接口。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="312-uvc协议">3.1.2 UVC协议<a href="#312-uvc协议" class="hash-link" aria-label="Direct link to 3.1.2 UVC协议" title="Direct link to 3.1.2 UVC协议">​</a></h3>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3121-uvc描述符">3.1.2.1 UVC描述符<a href="#3121-uvc描述符" class="hash-link" aria-label="Direct link to 3.1.2.1 UVC描述符" title="Direct link to 3.1.2.1 UVC描述符">​</a></h3>
<p>USB的描述符用于让主机知道设备的属性信息。设备刚连接主机时，主机会发送所有设备都支持的请求命令。通用的描述符包含设备描述符、配置描述符、接口描述符、端点描述符、字符串描述符。不同的设备类型可能会定义特有的描述符，用于对设备的描述扩展。</p>
<p>windows上可以使用UsbTreeView软件查看USB设备的描述符。下图展示了一个UVC设备其描述符的整体布局。</p>
<p><img decoding="async" loading="lazy" alt="usb_uvc_layout" src="/assets/images/usb_uvc_layout-7e9660ee3932998742500e78814e5b8a.png" width="777" height="659" class="img_ev3q"></p>
<p>在该布述符布局中，首先第一项是设备描述符，其次是配置描述符，该设备拥有一个配置描述符。配置描述符后接一个接口关联描述符IAD,接口关联描述符IAD拥有一个视频控制接口VC和N个视频流接口。</p>
<p>视频控制接口包括视视频控制接口头描述符、输入终端描述符、处理单元描述符、编码单元描述符、输出终端描述符、中断断点描述符。</p>
<p>视频流接口中包括一个接口和与其对应的多个转换设置接口（Alternate Setting）。</p>
<p>主机端通过视频控制接口描述符，可以知晓UVC摄像头的拓扑结构，并进行控制。比如处理单元PU，包括背光、对比度、色度等等调节，主机端先通过描述符获知哪些是可调节项，然后再与UVC设备交互获知控制范围信息。</p>
<p><img decoding="async" loading="lazy" alt="usb_unit" src="/assets/images/usb_unit-872e53df9df672837978485046733299.png" width="625" height="311" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3122-uvc视频流格式选择">3.1.2.2 UVC视频流格式选择<a href="#3122-uvc视频流格式选择" class="hash-link" aria-label="Direct link to 3.1.2.2 UVC视频流格式选择" title="Direct link to 3.1.2.2 UVC视频流格式选择">​</a></h3>
<p>VS接口包含许多Format(YUV/MJPEG/H264等)，每个Format包含多个Frame(各种分辨率)。参数设置的过程需要主机和USB设备进行协商， 协商的过程大致如下图所示：</p>
<p><img decoding="async" loading="lazy" alt="usb_vs" src="/assets/images/usb_vs-8b18af9663726d28caea44e58e8af9c6.png" width="426" height="381" class="img_ev3q"></p>
<p>流程说明：</p>
<ul>
<li>Host 先将期望的设置发送给USB设备(PROBE)</li>
<li>设备将Host期望设置在自身能力范围之内进行修改，返回给Host(PROBE)</li>
<li>Host 认为设置可行的话，Commit 提交(COMMIT)</li>
<li>设置接口的当前设置为某一个设置</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3123-uvc视频流负载">3.1.2.3 UVC视频流负载<a href="#3123-uvc视频流负载" class="hash-link" aria-label="Direct link to 3.1.2.3 UVC视频流负载" title="Direct link to 3.1.2.3 UVC视频流负载">​</a></h3>
<p><img decoding="async" loading="lazy" alt="uvc_payload" src="/assets/images/uvc_payload-cdae8c76885368f1801cfee4557a4a05.png" width="699" height="519" class="img_ev3q"></p>
<p>可以看到payload data前面包含一个header，payload data包含多个USB包，主机端是如何识别一帧图像数据的呢？通过payload header来识别。</p>
<p>payload header固定前2字节和后面的扩展部分。重点关注FID-不同的格式规定有差异。但所有的格式都是使用该bit在0和1之间切换来识别新一帧图像数据的。</p>
<p><img decoding="async" loading="lazy" alt="uvc_payload" src="/assets/images/uvc_payload_header-70dc6ccf9b71085bc631391ba8b9941b.png" width="1305" height="559" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="32-linux驱动层">3.2 linux驱动层<a href="#32-linux驱动层" class="hash-link" aria-label="Direct link to 3.2 linux驱动层" title="Direct link to 3.2 linux驱动层">​</a></h3>
<p>K230的SDK设计，为了性能把视频音频功能放在大核RTT上。linux上USB的功能实现很成熟，所以基于linux开发UVC功能，通过核间mapi通信获取大核视频数据。</p>
<p><img decoding="async" loading="lazy" alt="uvc_payload" src="/assets/images/uvc_framework-b338944e2eba6bdfc2e46b8d0a99b2e9.png" width="359" height="397" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="321-控制器驱动">3.2.1 控制器驱动<a href="#321-控制器驱动" class="hash-link" aria-label="Direct link to 3.2.1 控制器驱动" title="Direct link to 3.2.1 控制器驱动">​</a></h3>
<p><img decoding="async" loading="lazy" alt="usb_gadget" src="data:image/png;base64,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" width="307" height="160" class="img_ev3q"></p>
<p>K230集成了新思科技的USB模块，linux/drivers/usb/dwc2目录为该控制器的驱动。</p>
<p>目前的SDK设计UVC固定使用USB1，otg通过ID信号识别为device模式。</p>
<p>platform.c，做一些复位，注册中断，配置参数等操作。SDK的USB默认支持buffer DMA模式。Scatter Gather DMA模式可以提升ISO传输性能，HOST模式使用该DMA模式不能支持HUB。</p>
<p>gadget.c，重点关注该驱动代码，dwc2_gadget_init初始化重要的结构体，gadget.ops和ep.ops。usb_ep_ops的queue就是提交数据收发的请求，实际上是把这个请求放到一个处理链表。USB会挨个处理这些链表上的请求然后上报完成回调。</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">//设备树</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">usbotg1</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> usb</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">otg@</span><span class="token number" style="color:#36acaa">91540000</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    compatible </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;kendryte,k230-otg&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    reg </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token number" style="color:#36acaa">0x0</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0x91540000</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0x0</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0x10000</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    interrupt</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">parent </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">intc</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    interrupts </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token number" style="color:#36acaa">174</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    g</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">rx</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">fifo</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">size </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token number" style="color:#36acaa">512</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    g</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">np</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">tx</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">fifo</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">size </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token number" style="color:#36acaa">64</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    g</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">tx</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">fifo</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">size </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token number" style="color:#36acaa">512</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1024</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">64</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">64</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">64</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">64</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dr_mode </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;otg&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    otg</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">rev </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token number" style="color:#36acaa">0x200</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="322-gadget驱动">3.2.2 gadget驱动<a href="#322-gadget驱动" class="hash-link" aria-label="Direct link to 3.2.2 gadget驱动" title="Direct link to 3.2.2 gadget驱动">​</a></h3>
<p>源码位于linux/drivers/usb/gadget</p>
<ul>
<li>legacy：整个Gadget 设备驱动的入口。位于driver/usb/gadget/legacy下，里面给出了常用的usb类设备的驱动sample。其作用就是配置USB设备描述符信息，提供一个usb_composite_driver, 然后注册到composite层。也可以通过functionfs动态创建，这种方式更灵活，K230提供的usb gadget demo都是采用这种方式。</li>
<li>functions：各种usb 子类设备功能驱动。位于driver/usb/gadget/functions,里面也给出了对应的sample。其作用是配置USB子类协议的接口描述以及其他子类协议，比如uvc协议，hid等。uvc涉及到的相关文件uvc_video.c、uvc_v4l2.c、uvc_queue.c、uvc_configfs.c、f_uvc.c</li>
</ul>
<p>K230的UVC几乎未对gadget驱动层做修改，仅仅是移植了支持H264格式功能和扩展单元。</p>
<p>linux编译内核添加USB Gadget框架</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">-&gt; Device Drivers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -&gt; USB support</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        -&gt; USB Gadget Support</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="udc_linux_menuconfig" src="/assets/images/udc_linux_menuconfig-5d62b9d3673d038390b4b45ee405a8be.png" width="826" height="286" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" alt="uvc_linux_menuconfig" src="/assets/images/uvc_linux_menuconfig-7fa09ee63dad754b8bd40d5c21502471.png" width="804" height="482" class="img_ev3q"></p>
<p>uvc涉及到v4l2模块的功能，还需要添加media框架</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">-&gt; Device Drivers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -&gt; Multimedia support</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        -&gt; Media core support</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            -&gt; Media core support</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="media_linux_menuconfig" src="/assets/images/media_linux_menuconfig-08a3b40b2351d4ef1cf9ccfec43c532c.png" width="796" height="152" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="33-uvc-gadget应用层">3.3 uvc-gadget应用层<a href="#33-uvc-gadget应用层" class="hash-link" aria-label="Direct link to 3.3 uvc-gadget应用层" title="Direct link to 3.3 uvc-gadget应用层">​</a></h3>
<p>从K230的SDK设计架构可以看到，K230的UVC功能与单纯的linux上的uvc功能的差别就是获取视频数据的方式是通过核间通信从大核RTT获取的。</p>
<p>K230 UVC应用层的代码位置：cdk/user/mapi/sample/camera</p>
<p>源代码文件描述:</p>
<p>application.c - 主函数</p>
<p>camera.c - 提供摄像头对象操作，可以包含uvc/uac的控制</p>
<p>frame_cache.c - 复杂buffer的管理</p>
<p>kstream.c - 实现视频流操作</p>
<p>kuvc.c - 实现kuvc对象操作</p>
<p>sample_venc.c - 通过mapi从大核获取编码图像的操作</p>
<p>sample_yuv.c - 通过mapi从大核获取YUV图像的操作</p>
<p>uvc-gadget.c - 实现uvc设备操作</p>
<p>调试的步骤是先移植linux上通用的uvc_app，在linux上跑通standalone功能，也就是播放固定图像数据。然后再调试播放真实摄像头图像数据的功能。</p>
<p>下面是K230 UVC APP的设计流程图</p>
<p><img decoding="async" loading="lazy" alt="uvc_app_flow" src="/assets/images/uvc_app_flow-40f3c2f23d3a2160a760f01af4785348.png" width="535" height="597" class="img_ev3q"></p>
<p>uvc app大部分操作都是通用的操作，互联网上资料比较多。这里说一下K230私有的操作，重点关注venc_normalp_classic函数的处理。</p>
<ul>
<li>首先配置vicap 设备属性信息，包括摄像头类型等
kd_mapi_vicap_set_dev_attr</li>
<li>获取摄像头信息，主要是获取摄像头输出的图像分辨率 k_vicap_sensor_info</li>
<li>根据需要从vicap输出的图像计算出需要的vb buffer大小，并分配好buffer kd_mapi_media_init</li>
<li>配置通道属性，包括输出的分辨率，格式等 kd_mapi_vicap_set_chn_attr</li>
<li>启动video处理 kd_mapi_vicap_start<!-- -->
<ul>
<li>获取一帧图像 kd_mapi_vicap_dump_frame</li>
<li>释放图像 buffer kd_mapi_vicap_release_frame</li>
</ul>
</li>
<li>初始化venc模块，包括编码格式，帧率，分辨率等等 kd_mapi_venc_init</li>
<li>注册编码完成后的回调函数 kd_mapi_venc_registercallback</li>
<li>使能H264 GOP间隔产生IDR帧 kd_mapi_venc_enable_idr</li>
<li>启动venc kd_mapi_venc_start</li>
<li>venc模块绑定vi模块 kd_mapi_venc_bind_vi<!-- -->
<ul>
<li>编码完成后的回调函数，获取编码后的图像数据 get_venc_stream</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="34-参考资料学习推荐">3.4 参考资料学习推荐<a href="#34-参考资料学习推荐" class="hash-link" aria-label="Direct link to 3.4 参考资料学习推荐" title="Direct link to 3.4 参考资料学习推荐">​</a></h3>
<ul>
<li><a href="https://www.usb.org/document-library/usb-20-specification" target="_blank" rel="noopener noreferrer">USB2.0官方文档下载</a></li>
<li><a href="https://www.usb.org/document-library/video-class-v11-document-set" target="_blank" rel="noopener noreferrer">UUV1.1官方文档下载</a></li>
<li><a href="https://www.usb.org/document-library/video-class-v15-document-set" target="_blank" rel="noopener noreferrer">UUV1.5官方文档下载</a></li>
<li><a href="https://www.usbzh.com/article/forum-12.html" target="_blank" rel="noopener noreferrer">USB中文网</a></li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/CanaanK230/part3/06_K230USBapplicationisUVCtransmissionofYUVandcodedstreams.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/CanaanK230/part3/K230RVVActualcombat"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">K230 RVV实战</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/CanaanK230/part3/K230imagepracticebootvideoandbootlogo"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">K230 图像实战 - 开机视频和开机logo</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#概述" class="table-of-contents__link toc-highlight">概述</a></li><li><a href="#1-环境准备" class="table-of-contents__link toc-highlight">1. 环境准备</a><ul><li><a href="#11-硬件环境" class="table-of-contents__link toc-highlight">1.1 硬件环境</a></li><li><a href="#12-软件环境" class="table-of-contents__link toc-highlight">1.2 软件环境</a></li></ul></li><li><a href="#2-sdk-uvc-demo体验" class="table-of-contents__link toc-highlight">2. SDK UVC demo体验</a><ul><li><a href="#21-release-sdk编译固件烧录固件" class="table-of-contents__link toc-highlight">2.1 release sdk编译固件，烧录固件</a></li><li><a href="#22-执行命令测试demo" class="table-of-contents__link toc-highlight">2.2 执行命令测试demo</a></li></ul></li><li><a href="#3-如何开发uvc功能" class="table-of-contents__link toc-highlight">3. 如何开发UVC功能</a><ul><li><a href="#31-usbuvc协议" class="table-of-contents__link toc-highlight">3.1 USB/UVC协议</a></li><li><a href="#311-usb协议" class="table-of-contents__link toc-highlight">3.1.1 USB协议</a></li><li><a href="#312-uvc协议" class="table-of-contents__link toc-highlight">3.1.2 UVC协议</a></li><li><a href="#3121-uvc描述符" class="table-of-contents__link toc-highlight">3.1.2.1 UVC描述符</a></li><li><a href="#3122-uvc视频流格式选择" class="table-of-contents__link toc-highlight">3.1.2.2 UVC视频流格式选择</a></li><li><a href="#3123-uvc视频流负载" class="table-of-contents__link toc-highlight">3.1.2.3 UVC视频流负载</a></li><li><a href="#32-linux驱动层" class="table-of-contents__link toc-highlight">3.2 linux驱动层</a></li><li><a href="#321-控制器驱动" class="table-of-contents__link toc-highlight">3.2.1 控制器驱动</a></li><li><a href="#322-gadget驱动" class="table-of-contents__link toc-highlight">3.2.2 gadget驱动</a></li><li><a href="#33-uvc-gadget应用层" class="table-of-contents__link toc-highlight">3.3 uvc-gadget应用层</a></li><li><a href="#34-参考资料学习推荐" class="table-of-contents__link toc-highlight">3.4 参考资料学习推荐</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://dongshanpi.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">DongshanPI<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://canaan-docs.100ask.net/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Canaan-Docs<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://renesas-docs.100ask.net/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Renesas-Docs<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://rtos.100ask.net/" target="_blank" rel="noopener noreferrer" class="footer__link-item">RTOS<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://tina.100ask.net/" target="_blank" rel="noopener noreferrer" class="footer__link-item">TinaSDK-Docs<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://allwinner-docs.100ask.net/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Allwinner-Docs<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://aw-r128.100ask.net/" target="_blank" rel="noopener noreferrer" class="footer__link-item">R128-Docs<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://space.bilibili.com/275908810" target="_blank" rel="noopener noreferrer" class="footer__link-item">BiliBili<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://forums.100ask.net" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://video.100ask.net/" target="_blank" rel="noopener noreferrer" class="footer__link-item">VideoCenter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/dongshanpi" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://weidongshan.coding.net/public/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Coding<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/100askTeam" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://gitee.com/weidongshan" target="_blank" rel="noopener noreferrer" class="footer__link-item">Gitee<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>