"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[445],{58794:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>t,default:()=>_,frontMatter:()=>o,metadata:()=>l,toc:()=>c});var s=i(74848),r=i(28453);const o={sidebar_position:4},t="K230 \u542f\u52a8\u4f18\u5316\u6307\u5357",l={id:"CanaanK230/part6/K230LaunchtheOptimizationGuide",title:"K230 \u542f\u52a8\u4f18\u5316\u6307\u5357",description:"1.k230\u542f\u52a8\u987a\u5e8f",source:"@site/docs/CanaanK230/part6/04_K230LaunchtheOptimizationGuide.md",sourceDirName:"CanaanK230/part6",slug:"/CanaanK230/part6/K230LaunchtheOptimizationGuide",permalink:"/docs/CanaanK230/part6/K230LaunchtheOptimizationGuide",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/CanaanK230/part6/04_K230LaunchtheOptimizationGuide.md",tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4},sidebar:"canaanK230Sidebar",previous:{title:"K230 \u5185\u5b58\u5206\u6790\u6307\u5357",permalink:"/docs/CanaanK230/part6/K230MemoryAnalysisGuide"},next:{title:"K230\u5927\u5c0f\u6838\u901a\u8bafSharefs\u4f7f\u7528\u7b80\u4ecb",permalink:"/docs/CanaanK230/part6/K230IntroductiontotheuseofSharefsintheBigandSmallCoreCommunication"}},d={},c=[{value:"1.k230\u542f\u52a8\u987a\u5e8f",id:"1k230\u542f\u52a8\u987a\u5e8f",level:2},{value:"2.\u542f\u52a8\u65f6\u95f4\u6d4b\u91cf",id:"2\u542f\u52a8\u65f6\u95f4\u6d4b\u91cf",level:2},{value:"2.1 \u8f6f\u4ef6\u6d4b\u91cf",id:"21-\u8f6f\u4ef6\u6d4b\u91cf",level:3},{value:"2.2 \u786c\u4ef6\u6d4b\u91cf",id:"22-\u786c\u4ef6\u6d4b\u91cf",level:3},{value:"2.3 \u5916\u90e8\u89c2\u6d4b",id:"23-\u5916\u90e8\u89c2\u6d4b",level:3},{value:"3.\u7cfb\u7edf\u88c1\u526a",id:"3\u7cfb\u7edf\u88c1\u526a",level:2},{value:"3.1 \u5c0f\u6838\u88c1\u526a",id:"31-\u5c0f\u6838\u88c1\u526a",level:3},{value:"3.1.1 linux\u955c\u50cf\u88c1\u526a",id:"311-linux\u955c\u50cf\u88c1\u526a",level:4},{value:"3.1.2 rootfs\u88c1\u526a",id:"312-rootfs\u88c1\u526a",level:4},{value:"3.1.3 \u6587\u4ef6\u7cfb\u7edf\u9009\u578b",id:"313-\u6587\u4ef6\u7cfb\u7edf\u9009\u578b",level:4},{value:"3.2\u5927\u6838\u88c1\u526a",id:"32\u5927\u6838\u88c1\u526a",level:3},{value:"3.2.1 \u5927\u6838\u5e94\u7528\u7a0b\u5e8f\u88c1\u526a",id:"321-\u5927\u6838\u5e94\u7528\u7a0b\u5e8f\u88c1\u526a",level:4},{value:"3.3 \u88c1\u526a\u6548\u679c",id:"33-\u88c1\u526a\u6548\u679c",level:3},{value:"4.uboot\u542f\u52a8\u4f18\u5316",id:"4uboot\u542f\u52a8\u4f18\u5316",level:2},{value:"5.linux\u542f\u52a8\u4f18\u5316",id:"5linux\u542f\u52a8\u4f18\u5316",level:2},{value:"5.1 \u5220\u9664\u5185\u6838\u542f\u52a8\u6253\u5370",id:"51-\u5220\u9664\u5185\u6838\u542f\u52a8\u6253\u5370",level:3},{value:"5.2 \u5c06\u8017\u65f6\u7684\u9a71\u52a8\u7f16\u4e3a\u6a21\u5757",id:"52-\u5c06\u8017\u65f6\u7684\u9a71\u52a8\u7f16\u4e3a\u6a21\u5757",level:3},{value:"5.3 \u5e94\u7528\u7a0b\u5e8f\u542f\u52a8\u4f18\u5316",id:"53-\u5e94\u7528\u7a0b\u5e8f\u542f\u52a8\u4f18\u5316",level:3},{value:"6.\u5927\u6838\u542f\u52a8\u4f18\u5316",id:"6\u5927\u6838\u542f\u52a8\u4f18\u5316",level:2},{value:"6.1 rt-smart\u542f\u52a8",id:"61-rt-smart\u542f\u52a8",level:3},{value:"6.2 \u5e94\u7528\u7a0b\u5e8f\u4f18\u5316",id:"62-\u5e94\u7528\u7a0b\u5e8f\u4f18\u5316",level:3},{value:"7.\u5176\u4ed6\u4f18\u5316",id:"7\u5176\u4ed6\u4f18\u5316",level:2},{value:"8.\u4f18\u5316\u6548\u679c",id:"8\u4f18\u5316\u6548\u679c",level:2}];function a(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"k230-\u542f\u52a8\u4f18\u5316\u6307\u5357",children:"K230 \u542f\u52a8\u4f18\u5316\u6307\u5357"})}),"\n",(0,s.jsx)(n.h2,{id:"1k230\u542f\u52a8\u987a\u5e8f",children:"1.k230\u542f\u52a8\u987a\u5e8f"}),"\n",(0,s.jsx)(n.p,{children:"k230\u6574\u4f53\u542f\u52a8\u6d41\u7a0b\u5982\u4e0b\u56fe\u6240\u793a"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"k230\u6574\u4f53\u542f\u52a8\u6d41\u7a0b\u56fe",src:i(16617).A+"",width:"1280",height:"660"})}),"\n",(0,s.jsx)(n.h2,{id:"2\u542f\u52a8\u65f6\u95f4\u6d4b\u91cf",children:"2.\u542f\u52a8\u65f6\u95f4\u6d4b\u91cf"}),"\n",(0,s.jsx)(n.h3,{id:"21-\u8f6f\u4ef6\u6d4b\u91cf",children:"2.1 \u8f6f\u4ef6\u6d4b\u91cf"}),"\n",(0,s.jsx)(n.p,{children:"k230\u7684CPU\u6838\u4e3aRISCV\uff0c\u7528\u6237\u53ef\u4ee5\u5728\u5927\u5c0f\u6838\u7684\u4efb\u610f\u8f6f\u4ef6\u5185\u4f7f\u7528\u4ee5\u4e0b\u4ee3\u7801\u83b7\u53d6\u5f53\u524d\u65f6\u95f4\u3002"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:'uint64_t perf_get_smodecycles(void)\n{\n    uint64_t cnt;\n    __asm__ __volatile__(\n        "rdcycle %0" : "=r"(cnt)\n    );\n    return cnt;\n}\n'})}),"\n",(0,s.jsx)(n.p,{children:"\u83b7\u53d6\u7684\u503c\u4e3a\u5f53\u524dCPU\u8fd0\u884c\u7684\u65f6\u949f\u5468\u671f\u6570\uff0c\u9664\u4ee5CPU\u7684\u9891\u7387\u5373\u4e3a\u5f53\u524d\u8fd0\u884c\u7684\u65f6\u95f4\u3002k230_sdk\u9ed8\u8ba4\u5927\u6838\u7684\u65f6\u949f\u9891\u7387\u4e3a1.6GHz\uff0c\u5c0f\u6838\u7684\u65f6\u949f\u9891\u7387\u4e3a800MHz\u3002"}),"\n",(0,s.jsx)(n.h3,{id:"22-\u786c\u4ef6\u6d4b\u91cf",children:"2.2 \u786c\u4ef6\u6d4b\u91cf"}),"\n",(0,s.jsxs)(n.p,{children:["\u5728\u9700\u8981\u6d4b\u91cf\u7684\u70b9\u52a0\u5165GPIO\u7684\u8fb9\u6cbf\u53d8\u5316\uff0c\u901a\u8fc7\u903b\u8f91\u5206\u6790\u4eea\u6216\u793a\u6ce2\u5668\u53ef\u83b7\u5f97\u66f4\u7cbe\u51c6\u7684\u65f6\u95f4\u3002 \u53ef\u901a\u8fc7K230_EVB_LPDDR3_UNSIP\u677fJ1\u768414\u811a\u68c0\u6d4b\u5f00\u53d1\u677f\u4e0a\u7535\u4fe1\u53f7(\u9700\u8981\u7528\u8df3\u7ebf\u5e3d\u77ed\u63a515\u300116\u811a)\u3002 ",(0,s.jsx)(n.img,{alt:"\u903b\u8f91\u5206\u6790\u4eea\u7edf\u8ba1\u542f\u52a8\u65f6\u95f4",src:i(44029).A+"",width:"2537",height:"1219"})]}),"\n",(0,s.jsx)(n.h3,{id:"23-\u5916\u90e8\u89c2\u6d4b",children:"2.3 \u5916\u90e8\u89c2\u6d4b"}),"\n",(0,s.jsxs)(n.p,{children:["\u89c6\u9891\u5f55\u5236\u6574\u4e2a\u7cfb\u7edf\u542f\u52a8\u8fc7\u7a0b\uff0c\u677f\u8f7d\u7535\u6e90\u706f\u4eae\u4ee3\u8868\u7cfb\u7edf\u4e0a\u7535\uff0cVO\u663e\u793aVI\u56fe\u50cf\u4ee3\u8868\u89c6\u9891pipeline\u5b8c\u6210\u5efa\u7acb\u4e14\u53ef\u4ee5\u663e\u793a\u3002\u51fa\u73b0\u753b\u6846\u6846\u4f4f\u4eba\u8138\u8868\u793a\u5b8c\u6210\u4eba\u8138\u8bc6\u522b\u3002 ",(0,s.jsx)(n.img,{alt:"\u526a\u8f91\u8f6f\u4ef6\u5206\u6790\u542f\u52a8\u65f6\u95f4",src:i(34397).A+"",width:"1923",height:"1241"})]}),"\n",(0,s.jsx)(n.h2,{id:"3\u7cfb\u7edf\u88c1\u526a",children:"3.\u7cfb\u7edf\u88c1\u526a"}),"\n",(0,s.jsx)(n.p,{children:"\u4ece\u4e0a\u4e00\u8282\u7684\u56fe\u4e2d\u770b\u51fabootrom\u542f\u52a8\u540e\u7b2c\u4e00\u6b65\u5c31\u662f\u8981\u52a0\u8f7d\u5927\u5c0f\u6838\u7684\u955c\u50cf\uff0c\u6240\u4ee5\u4f18\u5316\u542f\u52a8\u65f6\u95f4\u7684\u7b2c\u4e00\u6b65\u5c31\u662f\u8981\u5148\u88c1\u526a\u5927\u5c0f\u6838\u955c\u50cf\u3002"}),"\n",(0,s.jsx)(n.h3,{id:"31-\u5c0f\u6838\u88c1\u526a",children:"3.1 \u5c0f\u6838\u88c1\u526a"}),"\n",(0,s.jsx)(n.h4,{id:"311-linux\u955c\u50cf\u88c1\u526a",children:"3.1.1 linux\u955c\u50cf\u88c1\u526a"}),"\n",(0,s.jsx)(n.p,{children:"\u8bf7\u53c2\u8003\u6587\u6863 \u4e2d\u7684Linux\u6a21\u5757\u5220\u9664\u7ae0\u8282\u3002"}),"\n",(0,s.jsx)(n.h4,{id:"312-rootfs\u88c1\u526a",children:"3.1.2 rootfs\u88c1\u526a"}),"\n",(0,s.jsxs)(n.p,{children:["\u5220\u9664rootfs\u4e2d\u4e0d\u4f1a\u88ab\u4f7f\u7528\u7684\u7a0b\u5e8f\u6216\u5e93\uff0c\u5bf9\u4e8e\u95e8\u9501POC\u9879\u76ee\u4e3b\u8981\u5305\u62ec\u5982\u4e0b\u5185\u5bb9\uff0c\u88c1\u526a\u8fc7\u7a0b\u53c2\u8003\u6587\u4ef6",(0,s.jsx)(n.code,{children:"k230_sdk/board/k230_evb_doorlock/gen_image_script/gen_doorlock_image.sh"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"rm -rf usr/bin/fio;\nrm -rf usr/bin/lvgl_demo_widgets;\nrm -rf usr/bin/ssh*\nrm -rf usr/bin/sftp\nrm -rf usr/bin/lat*\nrm -rf usr/bin/hostapd_cli\nrm -rf usr/bin/*test*\nrm -rf usr/bin/k230_timer_demo\nrm -rf usr/bin/gpio_keys_demo\nrm -rf lib/modules/5.10.4+/kernel/drivers/gpu/\nrm -rf lib/tuning-server;\nrm -rf usr/bin/stress-ng  bin/bash usr/sbin/sshd usr/bin/trace-cmd usr/bin/lvgl_demo_widgets;\n"})}),"\n",(0,s.jsx)(n.h4,{id:"313-\u6587\u4ef6\u7cfb\u7edf\u9009\u578b",children:"3.1.3 \u6587\u4ef6\u7cfb\u7edf\u9009\u578b"}),"\n",(0,s.jsx)(n.p,{children:"\u5f53\u524dnor flash\u652f\u6301\u7684\u6587\u4ef6\u7cfb\u7edf\u6709ubifs\u548cjffs2\uff0c\u95e8\u9501POC\u9ed8\u8ba4\u4f7f\u7528ubifs\u7684\u955c\u50cf\u3002\u4ed6\u4eec\u90fd\u662f\u538b\u7f29\u6587\u4ef6\u7cfb\u7edf\uff0cubifs\u7684\u8bfb\u5199\u6027\u80fd\u8981\u5f3a\u4e8ejffs2\u3002\u6ce8\u610f\u4f7f\u7528ubifs\u6587\u4ef6\u7cfb\u7edf\u65f6\uff0c\u7cfb\u7edf\u4e0b\u7535\u524d\uff0c\u5c0f\u6838\u9700\u8981\u5148\u8f93\u5165halt\u547d\u4ee4\uff0c\u518d\u8fdb\u884c\u65ad\u7535\u5426\u5219\u53ef\u80fd\u4f1a\u5bf9\u6587\u4ef6\u7cfb\u7edf\u9020\u6210\u7834\u574f"}),"\n",(0,s.jsx)(n.h3,{id:"32\u5927\u6838\u88c1\u526a",children:"3.2\u5927\u6838\u88c1\u526a"}),"\n",(0,s.jsx)(n.h4,{id:"321-\u5927\u6838\u5e94\u7528\u7a0b\u5e8f\u88c1\u526a",children:"3.2.1 \u5927\u6838\u5e94\u7528\u7a0b\u5e8f\u88c1\u526a"}),"\n",(0,s.jsxs)(n.p,{children:["strip\u4f1a\u53bb\u6389\u5e94\u7528\u7a0b\u5e8f\u4e0e\u5e93\u7684\u7b26\u53f7\u4fe1\u606f\u548c\u8c03\u8bd5\u4fe1\u606f\uff0c\u5927\u5927\u51cf\u5c11\u7a7a\u95f4\u5360\u7528\u3002\u7f16\u8bd1\u95e8\u9501POC\u65f6\uff0c\u4f1a\u5728",(0,s.jsx)(n.code,{children:"k230_sdk/board/k230_evb_doorlock/gen_image_script/gen_doorlock_image.sh"}),"\u4e2d\u88c1\u526a\u5927\u6838\u5e94\u7528\u7a0b\u5e8f\u3002"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"/opt/toolchain/riscv64-linux-musleabi_for_x86_64-pc-linux-gnu/bin/riscv64-unknown-linux-musl-strip fastboot_app.elf;\n"})}),"\n",(0,s.jsx)(n.h3,{id:"33-\u88c1\u526a\u6548\u679c",children:"3.3 \u88c1\u526a\u6548\u679c"}),"\n",(0,s.jsx)(n.p,{children:"\u95e8\u9501POC\u9879\u76ee\u9ed8\u8ba4\u4f7f\u7528\u7684\u662f\u88c1\u526a\u540e\u7684\u955c\u50cf\uff0c\u5404\u955c\u50cf\u5927\u5c0f\u5982\u4e0b"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u5c0f\u6838rootfs.ubifs 11M"}),"\n",(0,s.jsx)(n.li,{children:"\u5c0f\u6838\u7cfb\u7edf\u538b\u7f29\u955c\u50cflinux_system.bin(opensbi + image + dtb) 3.8M"}),"\n",(0,s.jsx)(n.li,{children:"\u5927\u6838\u7cfb\u7edf\u538b\u7f29\u955c\u50cfrtt_system.bin(opensbi + rtthread.bin) 1.2M"}),"\n",(0,s.jsx)(n.li,{children:"\u5927\u6838\u5e94\u7528\u7a0b\u5e8ffastboot_app.elf 11M"}),"\n",(0,s.jsx)(n.li,{children:"\u5927\u6838AI\u6a21\u578b mbface.kmodel + retinaface.kmodel 1.9M"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"4uboot\u542f\u52a8\u4f18\u5316",children:"4.uboot\u542f\u52a8\u4f18\u5316"}),"\n",(0,s.jsxs)(n.p,{children:["k230_sdk\u9488\u5bf9uboot\u4ee3\u7801\uff0c\u96c6\u6210\u4e86\u5feb\u542f\u914d\u7f6e\uff0cuboot\u672c\u8eab\u7684\u8fd0\u884c\u5206\u4e3a\u4fe9\u6bb5SPL+UBOOT\uff0c\u5f53\u4f7f\u80fd\u5feb\u542f\u65f6SPL\u4f1a\u8d1f\u8d23\u52a0\u8f7d\u540e\u7eed\u7684\u5927\u5c0f\u6838\u955c\u50cf\u5e76\u8fd0\u884c\uff0c\u5f53\u6ca1\u6709\u4f7f\u80fd\u5feb\u542f\u65f6\uff0cSPL\u4f1a\u52a0\u8f7d\u540e\u534a\u6bb5\u7684UBOOT\u4ee3\u7801\u8fd0\u884c\u3002\u4ee3\u7801\u4f4d\u7f6e",(0,s.jsx)(n.code,{children:"little/uboot/board/canaan/common/k230_spl.c"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:'int spl_board_init_f(void)\n{\n    int ret = 0;\n    device_disable();\n    g_bootmod = sysctl_boot_get_boot_mode();\n    ddr_init_training();\n    memset(__bss_start, 0, (ulong)&__bss_end - (ulong)__bss_start);\n    if(quick_boot()){//\u9ed8\u8ba4\u5feb\u8d77\n        //record_boot_time_info("ls");\n        ret += k230_img_load_boot_sys(BOOT_SYS_AUTO);\n    }\n    ret = k230_img_load_boot_sys(BOOT_SYS_UBOOT);\n    if(ret )\n        printf("uboot boot failed\\n");\n\n    return ret;\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:["quick_boot\u7684\u8fd4\u56de\u7ed3\u679c\u53d7uboot\u7684\u73af\u5883\u53d8\u91cfquick_boot\u5f71\u54cd\uff0c\u7528\u6237\u53ef\u624b\u52a8\u5728uboot\u4e0b\u901a\u8fc7setenv\u547d\u4ee4\u914d\u7f6e\uff0c\u4e5f\u53ef\u4ee5\u5728k230_sdk\u4e2d\u901a\u8fc7",(0,s.jsx)(n.code,{children:"make menuconfig--\x3eboard configuration"}),"\u914d\u7f6equick_boot\u3002"]}),"\n",(0,s.jsx)(n.h2,{id:"5linux\u542f\u52a8\u4f18\u5316",children:"5.linux\u542f\u52a8\u4f18\u5316"}),"\n",(0,s.jsx)(n.h3,{id:"51-\u5220\u9664\u5185\u6838\u542f\u52a8\u6253\u5370",children:"5.1 \u5220\u9664\u5185\u6838\u542f\u52a8\u6253\u5370"}),"\n",(0,s.jsxs)(n.p,{children:["\u5728uboot\u7684\u9ed8\u8ba4\u73af\u5883\u53d8\u91cf\u914d\u7f6e\u4e2d\uff0c\u628aflash\u542f\u52a8\u65f6\u7684bootargs\u4e2d\u7684fw_devlink\u8bbe\u7f6e\u4e3aoff\uff0c\u4ee3\u7801\u6587\u4ef6\u4f4d\u7f6e\u4e3a",(0,s.jsx)(n.code,{children:"src/little/uboot/board/canaan/common/k230_img.c"}),"\u3002linux\u542f\u52a8\u65f6\u63a7\u5236\u53f0\u4e0d\u518d\u6253\u5370\u542f\u52a8\u65e5\u5fd7\uff0c\u8fdb\u5165linux\u547d\u4ee4\u884c\u540e\uff0c\u53ef\u4ee5\u901a\u8fc7dmesg\u67e5\u770b\u5185\u6838\u542f\u52a8\u65e5\u5fd7\u3002"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:'char *board_fdt_chosen_bootargs(void){\n    char *bootargs = env_get("bootargs");\n    if(NULL == bootargs) {\n        if(g_bootmod == SYSCTL_BOOT_SDIO0)\n            bootargs = "root=/dev/mmcblk0p3 loglevel=8 rw rootdelay=4 rootfstype=ext4 console=ttyS0,115200 crashkernel=256M-:128M earlycon=sbi";\n        else if(g_bootmod == SYSCTL_BOOT_SDIO1)\n            bootargs = "root=/dev/mmcblk1p3 loglevel=8 rw rootdelay=4 rootfstype=ext4 console=ttyS0,115200 crashkernel=256M-:128M earlycon=sbi";\n        else  if(g_bootmod == SYSCTL_BOOT_NORFLASH)\n            //bootargs = "root=/dev/mtdblock9 rw rootwait rootfstype=jffs2 console=ttyS0,115200 earlycon=sbi";\n            //bootargs = "ubi.mtd=9 rootfstype=ubifs rw root=ubi0_0 console=ttyS0,115200 earlycon=sbi";\n            bootargs = "ubi.mtd=9 rootfstype=ubifs rw root=ubi0_0 console=ttyS0,115200 earlycon=sbi fw_devlink=off quiet";\n    }\n    //printf("%s\\n",bootargs);\n    return bootargs;\n'})}),"\n",(0,s.jsx)(n.h3,{id:"52-\u5c06\u8017\u65f6\u7684\u9a71\u52a8\u7f16\u4e3a\u6a21\u5757",children:"5.2 \u5c06\u8017\u65f6\u7684\u9a71\u52a8\u7f16\u4e3a\u6a21\u5757"}),"\n",(0,s.jsxs)(n.p,{children:["\u95e8\u9501POC\u9700\u8981\u7528\u5230usb\u9a71\u52a8\u7528\u6765\u8fde\u63a5\u7f51\u7edc\uff0c\u4ee5\u53cammc\u9a71\u52a8\u7528\u6765\u5bfc\u5165\u4eba\u8138\u6570\u636e\u3002\u8fd9\u4fe9\u4e2a\u9a71\u52a8probe\u8f83\u4e3a\u8017\u65f6\uff0c\u4e14\u4f1a\u89e6\u53d1\u5916\u8bbe\u9a71\u52a8\u7684probe\u6d41\u7a0b\uff0c\u6240\u4ee5\u9700\u8981\u5c06\u8fd9\u4e9b\u9a71\u52a8\u7f16\u8bd1\u6210\u6a21\u5757\uff0c\u5185\u6838\u542f\u52a8\u540e\u4f1a\u4f7f\u7528modprobe\u673a\u5236\u81ea\u52a8\u52a0\u8f7d\u4ed6\u4eec\u3002config\u914d\u7f6e\u53ef\u53c2\u8003",(0,s.jsx)(n.code,{children:"k230_sdk/src/little/linux/arch/riscv/configs/k230_evb_doorlock_defconfig"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"CONFIG_MMC=m\n# CONFIG_MMC_TEST is not set\nCONFIG_MMC_SDHCI=m\nCONFIG_MMC_SDHCI_PLTFM=m\nCONFIG_MMC_SDHCI_OF_KENDRYTE=m\nCONFIG_USB=y\nCONFIG_USB_ANNOUNCE_NEW_DEVICES=y\nCONFIG_USB_STORAGE=y\nCONFIG_USB_DWC2=m\nCONFIG_USB_TEST=m\nCONFIG_USB_GADGET=m\nCONFIG_USB_SNP_UDC_PLAT=m\nCONFIG_USB_CONFIGFS=m\nCONFIG_USB_CONFIGFS_MASS_STORAGE=y\nCONFIG_USB_CONFIGFS_F_LB_SS=y\nCONFIG_USB_CONFIGFS_F_UVC=y\n"})}),"\n",(0,s.jsx)(n.h3,{id:"53-\u5e94\u7528\u7a0b\u5e8f\u542f\u52a8\u4f18\u5316",children:"5.3 \u5e94\u7528\u7a0b\u5e8f\u542f\u52a8\u4f18\u5316"}),"\n",(0,s.jsxs)(n.p,{children:["\u5c06\u5e94\u7528\u7a0b\u5e8f\u7684\u8fd0\u884c\u65f6\u95f4\u63d0\u524d\uff0c\u4fee\u6539\u6839\u6587\u4ef6\u7cfb\u7edf\u4e2d\u7684/etc/inittab\u6587\u4ef6\uff0c\u4f7f\u5176\u8fd0\u884c\u7684\u7b2c\u4e00\u4e2a\u8fdb\u7a0b\u4e3a\u6211\u4eec\u9700\u8981\u7387\u5148\u542f\u52a8\u7684\u7a0b\u5e8f\u3002\u4f8b\u5982\u5728",(0,s.jsx)(n.code,{children:"k230_sdk/board/k230_evb_doorlock/inittab"}),"\u6587\u4ef6\u4e2d\uff0c\u7cfb\u7edf\u7b2c\u4e00\u4e2a\u542f\u52a8\u7684\u8fdb\u7a0b\u4e3a",(0,s.jsx)(n.code,{children:"sysinit:nice -n -20 /app/door_lock/ui/ui &"}),"\u3002\u8fd9\u4e2ainitab\u6587\u4ef6\u5728\u7f16\u8bd1\u95e8\u9501\u955c\u50cf\u65f6\uff0c\u4f1a\u66ff\u6362\u8c03rootfs\u4e2d\u539f\u6765\u7684/etc/inittab\u6587\u4ef6\u3002\u5176\u4e2dui\u7a0b\u5e8f\u662f\u95e8\u9501POC\u7684\u5c0f\u6838\u5e94\u7528\u7a0b\u5e8f"]}),"\n",(0,s.jsx)(n.h2,{id:"6\u5927\u6838\u542f\u52a8\u4f18\u5316",children:"6.\u5927\u6838\u542f\u52a8\u4f18\u5316"}),"\n",(0,s.jsx)(n.h3,{id:"61-rt-smart\u542f\u52a8",children:"6.1 rt-smart\u542f\u52a8"}),"\n",(0,s.jsxs)(n.p,{children:["\u4fee\u6539rt-smart\u5185\u6838\u6e90\u7801\uff0c\u5728shell\u7ebf\u7a0b\u5efa\u7acb\u524d\u5148\u8fd0\u884c\u4e00\u4e2ainit.sh\u811a\u672c\uff0c\u5728\u811a\u672c\u4e2d\u5b9a\u4e49\u8981\u8fd0\u884c\u7684\u5927\u6838\u7a0b\u5e8f\u3002\u4ee3\u7801\u4f4d\u7f6e",(0,s.jsx)(n.code,{children:"big/rt-smart/kernel/rt-thread/components/finsh/shell.c"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:'if(shell_thread_first_run) {\n    shell_thread_first_run = 0;\n    msh_exec("/bin/init.sh", 13);\n    continue;\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"62-\u5e94\u7528\u7a0b\u5e8f\u4f18\u5316",children:"6.2 \u5e94\u7528\u7a0b\u5e8f\u4f18\u5316"}),"\n",(0,s.jsxs)(n.p,{children:["\u4ee5\u95e8\u9501poc\u4e3a\u4f8b:",(0,s.jsx)(n.code,{children:"k230_sdk/src/reference/business_poc/doorlock/big/"})]}),"\n",(0,s.jsx)(n.p,{children:"\u5e94\u7528\u7a0b\u5e8f\u53ef\u4ee5\u901a\u8fc7\u591a\u7ebf\u7a0b\u5e76\u884c\u7684\u65b9\u5f0f\u521d\u59cb\u5316\u5404\u8bbe\u5907\u3002\u4f8b\u5982\u5c06\u6838\u95f4\u901a\u8baf\u4ee5\u53cavo\u7684\u521d\u59cb\u5316\u5355\u72ec\u653e\u5728\u4e0d\u540c\u7684\u7ebf\u7a0b\u4e2d\u8fdb\u884c\u3002"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"    pthread_create(&ipc_message_handle, NULL, ipc_msg_server, NULL);\n    pthread_create(&exit_thread_handle, NULL, exit_app, NULL);\n    pthread_create(&vo_thread_handle, NULL, sample_vo_thread, NULL);\n"})}),"\n",(0,s.jsx)(n.h2,{id:"7\u5176\u4ed6\u4f18\u5316",children:"7.\u5176\u4ed6\u4f18\u5316"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"k230\u5185\u7f6e\u4e86\u786c\u4ef6\u89e3\u538b\u5355\u5143\uff0cSDK\u7f16\u8bd1\u7684flash\u955c\u50cf\u4e3a\u538b\u7f29\u955c\u50cf\uff0cuboot\u4f1a\u4f7f\u7528\u786c\u4ef6\u89e3\u538b\u5355\u5143\u5bf9\u540e\u7eed\u7684\u5404\u5927\u5c0f\u6838\u955c\u50cf\u8fdb\u884c\u89e3\u538b\uff0c\u5df2\u63d0\u9ad8\u52a0\u8f7d\u901f\u5ea6\u3002"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"8\u4f18\u5316\u6548\u679c",children:"8.\u4f18\u5316\u6548\u679c"}),"\n",(0,s.jsxs)(n.p,{children:["\u95e8\u9501POC\u7684\u542f\u52a8\u65f6\u95f4\u7edf\u8ba1\uff0c\u8be5\u7edf\u8ba1\u6570\u636e\u7684\u6d4b\u91cf\u65f6\u95f4\u4e3a6\u67089\u65e5\uff0c\u4e0e\u5f53\u524d\u6700\u65b0\u7684sdk\u7248\u672c\u6570\u636e\u53ef\u80fd\u5b58\u5728\u8bef\u5dee",(0,s.jsx)(n.img,{alt:"\u95e8\u9501POC\u542f\u52a8\u65f6\u95f4",src:i(96810).A+"",width:"1473",height:"709"})]})]})}function _(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(a,{...e})}):a(e)}},16617:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/boot-fa325eb338c5e3ee58b0af35006d7ca7.png"},44029:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/boot_time_edge-f941d2ade61ad1369e23d8189479ead6.jpg"},34397:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/boot_time_video-a34d62e30328bb19b8f6eb04b9078a5a.jpg"},96810:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/door_lock_boot_time-b9e47f4ca91c1c4ececad394c846b392.png"},28453:(e,n,i)=>{i.d(n,{R:()=>t,x:()=>l});var s=i(96540);const r={},o=s.createContext(r);function t(e){const n=s.useContext(o);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),s.createElement(o.Provider,{value:n},e.children)}}}]);