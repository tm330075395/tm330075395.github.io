"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[8754],{8431:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>r,contentTitle:()=>i,default:()=>h,frontMatter:()=>c,metadata:()=>l,toc:()=>t});var d=s(74848),f=s(28453);const c={sidebar_position:17},i="K230\u5c0f\u6838Linux\u9a71\u52a8API\u53c2\u8003",l={id:"CanaanK230/part7/K230ReferenceAPIsmall-coreLinuxdrivers",title:"K230\u5c0f\u6838Linux\u9a71\u52a8API\u53c2\u8003",description:"1 \u6982\u8ff0",source:"@site/docs/CanaanK230/part7/17_K230ReferenceAPIsmall-coreLinuxdrivers.md",sourceDirName:"CanaanK230/part7",slug:"/CanaanK230/part7/K230ReferenceAPIsmall-coreLinuxdrivers",permalink:"/docs/CanaanK230/part7/K230ReferenceAPIsmall-coreLinuxdrivers",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/CanaanK230/part7/17_K230ReferenceAPIsmall-coreLinuxdrivers.md",tags:[],version:"current",sidebarPosition:17,frontMatter:{sidebar_position:17},sidebar:"canaanK230Sidebar",previous:{title:"K230\u5927\u6838\u4f4e\u901f\u9a71\u52a8API\u53c2\u8003",permalink:"/docs/CanaanK230/part7/K230Large-corelow-speeddriveAPIreference"},next:{title:"8.\u5e38\u89c1\u95ee\u9898",permalink:"/docs/category/8\u5e38\u89c1\u95ee\u9898-1"}},r={},t=[{value:"1 \u6982\u8ff0",id:"1-\u6982\u8ff0",level:2},{value:"1.1 \u6982\u8ff0",id:"11-\u6982\u8ff0",level:3},{value:"1.2 \u529f\u80fd\u63cf\u8ff0",id:"12-\u529f\u80fd\u63cf\u8ff0",level:3},{value:"1.2.1 uart\u6a21\u5757",id:"121-uart\u6a21\u5757",level:4},{value:"1.2.2 i2c\u6a21\u5757",id:"122-i2c\u6a21\u5757",level:4},{value:"1.2.3 gpio\u6a21\u5757",id:"123-gpio\u6a21\u5757",level:4},{value:"1.2.4 hard-lock\u6a21\u5757",id:"124-hard-lock\u6a21\u5757",level:4},{value:"1.2.5 wdt\u6a21\u5757",id:"125-wdt\u6a21\u5757",level:4},{value:"1.2.6 OTP\u6a21\u5757",id:"126-otp\u6a21\u5757",level:4},{value:"1.2.7 TS\u6a21\u5757",id:"127-ts\u6a21\u5757",level:4},{value:"1.2.8 TRNG\u6a21\u5757",id:"128-trng\u6a21\u5757",level:4},{value:"1.2.9 ADC\u6a21\u5757",id:"129-adc\u6a21\u5757",level:4},{value:"1.2.10 PWM\u6a21\u5757",id:"1210-pwm\u6a21\u5757",level:4},{value:"2 API\u53c2\u8003",id:"2-api\u53c2\u8003",level:2},{value:"2.1 UART API\u53c2\u8003",id:"21-uart-api\u53c2\u8003",level:3},{value:"2.2 I2C API\u53c2\u8003",id:"22-i2c-api\u53c2\u8003",level:3},{value:"2.3 GPIO API\u53c2\u8003",id:"23-gpio-api\u53c2\u8003",level:3},{value:"2.3.1 sysfs\u63a7\u5236gpio",id:"231-sysfs\u63a7\u5236gpio",level:4},{value:"2.3.2 ioctl\u63a7\u5236gpio",id:"232-ioctl\u63a7\u5236gpio",level:4},{value:"2.4 Hardlock API\u53c2\u8003",id:"24-hardlock-api\u53c2\u8003",level:3},{value:"2.5 Wadtchdog API\u53c2\u8003",id:"25-wadtchdog-api\u53c2\u8003",level:3},{value:"2.5.1 \u901a\u8fc7ioctl\u4f7f\u7528watchdog",id:"251-\u901a\u8fc7ioctl\u4f7f\u7528watchdog",level:4},{value:"2.5.2 \u901a\u8fc7\u6587\u4ef6\u7cfb\u7edf\u4f7f\u7528watchdog",id:"252-\u901a\u8fc7\u6587\u4ef6\u7cfb\u7edf\u4f7f\u7528watchdog",level:4},{value:"2.6 OTP API \u53c2\u8003",id:"26-otp-api-\u53c2\u8003",level:3},{value:"2.6.1 sysfs \u6587\u4ef6\u7cfb\u7edf",id:"261-sysfs-\u6587\u4ef6\u7cfb\u7edf",level:4},{value:"2.6.2 \u7528\u6237\u6001\u8bbf\u95ee OTP",id:"262-\u7528\u6237\u6001\u8bbf\u95ee-otp",level:4},{value:"2.6.3 OTP \u7a7a\u95f4\u9ed8\u8ba4\u503c",id:"263-otp-\u7a7a\u95f4\u9ed8\u8ba4\u503c",level:4},{value:"2.7 TS API \u53c2\u8003",id:"27-ts-api-\u53c2\u8003",level:3},{value:"2.7.1 sysfs \u6587\u4ef6\u7cfb\u7edf",id:"271-sysfs-\u6587\u4ef6\u7cfb\u7edf",level:4},{value:"2.7.2 \u7528\u6237\u6001\u8bbf\u95ee TS",id:"272-\u7528\u6237\u6001\u8bbf\u95ee-ts",level:4},{value:"2.8 TRNG API \u53c2\u8003",id:"28-trng-api-\u53c2\u8003",level:3},{value:"2.8.1 sysfs \u6587\u4ef6\u7cfb\u7edf",id:"281-sysfs-\u6587\u4ef6\u7cfb\u7edf",level:4},{value:"2.8.2 \u7528\u6237\u6001\u8bbf\u95ee TRNG",id:"282-\u7528\u6237\u6001\u8bbf\u95ee-trng",level:4},{value:"2.9 ADC API\u53c2\u8003",id:"29-adc-api\u53c2\u8003",level:3},{value:"2.9.1 sysfs\u8bbf\u95ee ADC",id:"291-sysfs\u8bbf\u95ee-adc",level:4},{value:"2.9.2 \u7528\u6237\u6001\u8bbf\u95ee ADC",id:"292-\u7528\u6237\u6001\u8bbf\u95ee-adc",level:4},{value:"2.10 PWM API\u53c2\u8003",id:"210-pwm-api\u53c2\u8003",level:3},{value:"2.10.1 sysfs\u8bbf\u95ee PWM",id:"2101-sysfs\u8bbf\u95ee-pwm",level:4},{value:"2.10.2 \u7528\u6237\u6001\u8bbf\u95ee PWM",id:"2102-\u7528\u6237\u6001\u8bbf\u95ee-pwm",level:4},{value:"2.11 open",id:"211-open",level:3},{value:"2.12 ioctl",id:"212-ioctl",level:3},{value:"2.13 read",id:"213-read",level:3},{value:"2.14 write",id:"214-write",level:3}];function a(e){const n={a:"a",blockquote:"blockquote",code:"code",del:"del",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,f.R)(),...e.components};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(n.header,{children:(0,d.jsx)(n.h1,{id:"k230\u5c0f\u6838linux\u9a71\u52a8api\u53c2\u8003",children:"K230\u5c0f\u6838Linux\u9a71\u52a8API\u53c2\u8003"})}),"\n",(0,d.jsx)(n.h2,{id:"1-\u6982\u8ff0",children:"1 \u6982\u8ff0"}),"\n",(0,d.jsx)(n.h3,{id:"11-\u6982\u8ff0",children:"1.1 \u6982\u8ff0"}),"\n",(0,d.jsx)(n.p,{children:"UART\uff1a\n\u901a\u7528\u5f02\u6b65\u6536\u53d1\u5668\uff0c\u8be5\u603b\u7ebf\u53cc\u5411\u901a\u4fe1\uff0c\u53ef\u4ee5\u5b9e\u73b0\u5168\u53cc\u5de5\u4f20\u8f93\u548c\u63a5\u6536\u3002\u5728\u5d4c\u5165\u5f0f\u8bbe\u8ba1\u4e2d\uff0cUART\u7528\u6765\u4e0ePC\u8fdb\u884c\u901a\u4fe1\uff0c\u5305\u62ec\u4e0e\u76d1\u63a7\u8c03\u8bd5\u5668\u548c\u5176\u5b83\u5668\u4ef6\uff0c\u5982EEPROM\u901a\u4fe1\u3002"}),"\n",(0,d.jsx)(n.p,{children:"I2C\uff1a\n\u7531Philips\u516c\u53f8\uff082006\u5e74\u8fc1\u79fb\u5230NXP\uff09\u57281980\u5e74\u4ee3\u521d\u5f00\u53d1\u7684\u4e00\u79cd\u7b80\u5355\u3001\u53cc\u7ebf\u53cc\u5411\u7684\u540c\u6b65\u4e32\u884c\u603b\u7ebf\uff0c\u5b83\u5229\u7528\u4e00\u6839\u65f6\u949f\u7ebf\u548c\u4e00\u6839\u6570\u636e\u7ebf\u5728\u8fde\u63a5\u603b\u7ebf\u7684\u4e24\u4e2a\u5668\u4ef6\u4e4b\u95f4\u8fdb\u884c\u4fe1\u606f\u7684\u4f20\u9012\uff0c\u4e3a\u8bbe\u5907\u4e4b\u95f4\u6570\u636e\u4ea4\u6362\u63d0\u4f9b\u4e86\u4e00\u79cd\u7b80\u5355\u9ad8\u6548\u7684\u65b9\u6cd5\u3002\u6bcf\u4e2a\u8fde\u63a5\u5230\u603b\u7ebf\u4e0a\u7684\u5668\u4ef6\u90fd\u6709\u552f\u4e00\u7684\u5730\u5740\uff0c\u4efb\u4f55\u5668\u4ef6\u65e2\u53ef\u4ee5\u4f5c\u4e3a\u4e3b\u673a\u4e5f\u53ef\u4ee5\u4f5c\u4e3a\u4ece\u673a\uff0c\u4f46\u540c\u4e00\u65f6\u523b\u53ea\u5141\u8bb8\u6709\u4e00\u4e2a\u4e3b\u673a\u3002"}),"\n",(0,d.jsx)(n.p,{children:"GPIO\uff1a\n\uff08general porpose intput output\uff09\u901a\u7528\u8f93\u5165\u8f93\u51fa\u7aef\u53e3\u7684\u7b80\u79f0\u3002\u53ef\u4ee5\u901a\u8fc7\u8f6f\u4ef6\u63a7\u5236\u5176\u8f93\u51fa\u548c\u8f93\u5165\uff0c\u901a\u4fd7\u6765\u8bf4\u5c31\u662f\u5e38\u7528\u5f15\u811a\uff0c\u53ef\u4ee5\u63a7\u5236\u5f15\u811a\u7684\u9ad8\u4f4e\u7535\u5e73\uff0c\u5bf9\u5176\u8fdb\u884c\u8bfb\u53d6\u6216\u8005\u5199\u5165\u3002"}),"\n",(0,d.jsx)(n.p,{children:"Hard-lock\uff1a\n\u5609\u6960\u81ea\u7814\u6a21\u5757\uff0c\u7528\u4e8e\u540c\u6838\u4e0d\u901a\u8fdb\u7a0b\u95f4\u6216\u5f02\u6838\u4e4b\u95f4\u5bf9\u5171\u4eab\u8d44\u6e90\u7684\u4e92\u65a5\u800c\u5b9e\u73b0\u7684\u786c\u4ef6\u4e92\u65a5\u9501\uff0c\u53ef\u7528\u4e8e\u5bf9\u5171\u4eab\u8d44\u6e90\u7684\u4e92\u65a5\u4f7f\u7528\u3002"}),"\n",(0,d.jsx)(n.p,{children:"WDT\uff1a\nWDT\u662fwatchdog\u7684\u7b80\u79f0\uff0c\u672c\u8d28\u4e0a\u662f\u4e00\u4e2a\u786c\u4ef6\u5b9a\u65f6\u5668\uff0c\u8f6f\u4ef6\u7a0b\u5e8f\u9700\u8981\u6bcf\u9694\u4e00\u6bb5\u65f6\u95f4\u5582\u4e00\u6b21\u72d7\uff0c\u5982\u679cWDT\u8d85\u65f6\u5219\u53ef\u4ee5\u4ea7\u751f\u4e00\u4e2a\u4e2d\u65ad\u4fe1\u53f7\u6216\u590d\u4f4d\u4fe1\u53f7\u5230CPU\uff0c\u7531\u6b64\u901a\u8fc7\u8f6f\u786c\u4ef6\u7ed3\u5408\u7684\u65b9\u5f0f\u9632\u6b62\u7a0b\u5e8f\u8fd0\u884c\u5f02\u5e38\u800c\u4e0d\u80fd\u6062\u590d\u3002"}),"\n",(0,d.jsx)(n.p,{children:"OTP\uff1a\nOTP \u4e3b\u8981\u7528\u4e8e\u5b58\u50a8\u5b89\u5168\u654f\u611f\u7684\u673a\u5bc6\u4fe1\u606f\uff0c\u4f8b\u5982 bootrom \u7684\u56fa\u4ef6\u4fe1\u606f\u3001\u52a0\u89e3\u5bc6\u5bc6\u94a5\u3001\u7b7e\u540d\u4fe1\u606f\u4ee5\u53ca\u7528\u6237\u81ea\u5df1\u5b9a\u4e49\u7684\u5b89\u5168\u4fe1\u606f\u7b49\u3002"}),"\n",(0,d.jsx)(n.p,{children:"TS\uff1a\nK230 TS\uff08Temperature Sensor\uff09\uff0c\u81ea\u7814\u6e29\u5ea6\u4f20\u611f\u5668\uff0c\u91c7\u7528 TSMC 12nm \u5de5\u827a\uff0cTS \u7684\u5e94\u7528\u573a\u666f\u662f\u964d\u9891\u3002"}),"\n",(0,d.jsx)(n.p,{children:"TRNG\uff1a\nTRNG \u4e3b\u8981\u7528\u4e8e\u4ea7\u751f\u771f\u968f\u673a\u6570\uff0c\u4ece\u800c\u4e3a\u52a0\u89e3\u5bc6\u8fd0\u7b97\u63d0\u4f9b\u4e00\u4e2a\u968f\u673a\u71b5\u6e90\u3002"}),"\n",(0,d.jsx)(n.p,{children:"ADC\uff1a\nADC \u6307\u6a21\u6570\u8f6c\u6362\u5668\uff0c\u662f\u6307\u5c06\u8fde\u7eed\u53d8\u5316\u7684\u6a21\u62df\u4fe1\u53f7\u8f6c\u6362\u4e3a\u79bb\u6563\u7684\u6570\u5b57\u4fe1\u53f7\u7684\u5668\u4ef6\u3002"}),"\n",(0,d.jsx)(n.p,{children:"PWM\uff1a\nPWM \u8109\u51b2\u5bbd\u5ea6\u8c03\u5236\uff0c\u662f\u4e00\u79cd\u5bf9\u6a21\u62df\u4fe1\u53f7\u7535\u5e73\u8fdb\u884c\u6570\u5b57\u7f16\u7801\u7684\u65b9\u6cd5\uff0c\u901a\u8fc7\u8c03\u5236\u6b63\u8109\u51b2\u5468\u671f\u6240\u5360\u7684\u6bd4\u4f8b\u6765\u5bf9\u4e00\u4e2a\u5177\u4f53\u6a21\u62df\u4fe1\u53f7\u7684\u7535\u5e73\u8fdb\u884c\u7f16\u7801\u3002"}),"\n",(0,d.jsx)(n.h3,{id:"12-\u529f\u80fd\u63cf\u8ff0",children:"1.2 \u529f\u80fd\u63cf\u8ff0"}),"\n",(0,d.jsx)(n.h4,{id:"121-uart\u6a21\u5757",children:"1.2.1 uart\u6a21\u5757"}),"\n",(0,d.jsx)(n.p,{children:"K230\u5171\u67095\u8defuart\uff0c\u4e14uart\u6a21\u5757\u652f\u6301\u7ea2\u5916\u6a21\u5f0f\uff0c\u652f\u6301RS485\u6a21\u5f0f\uff0c\u652f\u6301DMA\uff0c\u90e8\u5206\u7aef\u53e3\u652f\u6301\u6d41\u63a7\uff0c\u6570\u636e\u4f4d\u652f\u63015/6/7/8\u6bd4\u7279\uff0c\u505c\u6b62\u4f4d1/2\u6bd4\u7279\uff0c\u6ce2\u7279\u7387\u53ef\u4ee5\u652f\u6301\u52301.5MHz\u3002"}),"\n",(0,d.jsx)(n.h4,{id:"122-i2c\u6a21\u5757",children:"1.2.2 i2c\u6a21\u5757"}),"\n",(0,d.jsx)(n.p,{children:"K230\u5171\u67095\u8defi2c\uff0ci2c\u6a21\u5757\u652f\u6301\u4e3b\u6a21\u5f0f\uff0c\u652f\u6301DMA\uff0c\u652f\u63017/10\u6bd4\u7279\u5bfb\u5740\uff0c\u652f\u6301\u4e2d\u65ad\uff0ci2c\u6a21\u5757\u4f20\u8f93\u901f\u7387\u652f\u6301100k/400k/1M/3.4M."}),"\n",(0,d.jsx)(n.h4,{id:"123-gpio\u6a21\u5757",children:"1.2.3 gpio\u6a21\u5757"}),"\n",(0,d.jsx)(n.p,{children:"k230\u5171\u67092\u8defgpio\uff0c\u6bcf\u8defgpio\u5305\u542b32\u4e2agpio\u7aef\u53e3\uff0c\u517164\u4e2agpio\u7aef\u53e3\uff0c\u6bcf\u4e2agpio\u7aef\u53e3\u5747\u652f\u6301\u8f93\u5165\u8f93\u51fa\u529f\u80fd\uff0c\u652f\u6301\u4e0a\u5347\u6cbf\u4e2d\u65ad\uff0c\u4e0b\u964d\u6cbf\u4e2d\u65ad\uff0c\u9ad8\u4f4e\u7535\u5e73\u4e2d\u65ad\uff0c\u548c\u53cc\u8fb9\u6cbf\u4e2d\u65ad\u3002k230\u7684\u6bcf\u4e2agpio\u7aef\u53e3\u7684\u4e2d\u65ad\u76f8\u4e92\u72ec\u7acb\u4e92\u4e0d\u5f71\u54cd\u3002"}),"\n",(0,d.jsx)(n.h4,{id:"124-hard-lock\u6a21\u5757",children:"1.2.4 hard-lock\u6a21\u5757"}),"\n",(0,d.jsx)(n.p,{children:"k230\u6709128\u4e2a\u786c\u4ef6\u4e92\u65a5\u9501\uff0c\u5176\u4f5c\u7528\u7c7b\u4f3cLinux\u7684\u81ea\u65cb\u9501\uff0c\u53ef\u4ee5\u7528\u4e8e\u5bf9\u540c\u4e00\u8d44\u6e90\u7684\u4e92\u65a5\u3002"}),"\n",(0,d.jsx)(n.h4,{id:"125-wdt\u6a21\u5757",children:"1.2.5 wdt\u6a21\u5757"}),"\n",(0,d.jsx)(n.p,{children:"wdt\uff0cwatchdog\u6a21\u5757\uff0ck230\u6709\u4e24\u8defwdt\uff0c\u5927\u5c0f\u6838\u5206\u522b\u4f7f\u7528\u4e00\u8def\uff0cwdt\u652f\u6301\u4e2d\u65ad\u548c\u590d\u4f4d\u4e24\u79cd\u6a21\u5f0f\uff0c\u9ed8\u8ba4\u4f7f\u7528\u590d\u4f4d\u6a21\u5f0f\uff0c\u5373\u5f53wdt\u7684\u8d85\u65f6\u65f6\u95f4\u6ea2\u51fa\u65f6\uff0c\u76f4\u63a5\u4f7fsoc\u590d\u4f4d\u3002"}),"\n",(0,d.jsx)(n.h4,{id:"126-otp\u6a21\u5757",children:"1.2.6 OTP\u6a21\u5757"}),"\n",(0,d.jsx)(n.p,{children:"OTP \u96c6\u6210\u5728\u5b89\u5168\u6a21\u5757 PUF \u4e2d\uff0c\u4e3a\u6574\u4e2a SoC \u63d0\u4f9b\u5b89\u5168\u5b58\u50a8\u529f\u80fd\uff0c\u4fdd\u62a4\u6839\u5bc6\u94a5\u548c\u542f\u52a8\u4ee3\u7801\u7b49\u5173\u952e\u6570\u636e\u4e0d\u88ab\u653b\u51fb\u8005\u7834\u574f\u3002\u5c0f\u6838\u4fa7 OTP \u9a71\u52a8\u4e3b\u8981\u63d0\u4f9b\u8bfb\u529f\u80fd\uff0c\u53ef\u8bfb\u533a\u57df\u4e3a\u5305\u62ec\u751f\u4ea7\u4fe1\u606f\u5728\u5185\u7684 24Kbits \u7a7a\u95f4\u3002Linux \u4fa7 OTP \u9a71\u52a8\u6302\u8f7d\u5728 nvmem \u6846\u67b6\u4e0a\uff0c\u5177\u4f53\u7684\u6846\u67b6\u7ed3\u6784\u5982\u4e0b\u56fe\u6240\u793a\uff1a"}),"\n",(0,d.jsx)(n.p,{children:(0,d.jsx)(n.img,{alt:"otp",src:s(32672).A+"",width:"2426",height:"2298"})}),"\n",(0,d.jsx)(n.h4,{id:"127-ts\u6a21\u5757",children:"1.2.7 TS\u6a21\u5757"}),"\n",(0,d.jsx)(n.p,{children:"\u5927\u6838\u4fa7 TS \u9a71\u52a8\u4e3b\u8981\u63d0\u4f9b\u8bfb\u529f\u80fd\uff0c\u5728\u8bfb TS \u4e4b\u524d\uff0c\u9996\u5148\u9700\u8981\u914d\u7f6e TS \u5bc4\u5b58\u5668\u4f7f\u80fd\u4fe1\u53f7\u3001\u8f93\u51fa\u6a21\u5f0f\uff0c\u7136\u540e\u624d\u80fd\u8bfb\u51fa\u82af\u7247\u7684\u7ed3\u6e29\u3002\u53e6\u5916\uff0cTS \u5bc4\u5b58\u5668\u6bcf 2.6s \u8bfb\u53d6\u4e00\u6b21\u82af\u7247\u7ed3\u6e29\u3002Rt-smart \u4fa7 TS \u9a71\u52a8\u7684\u7ed3\u6784\u5982\u4e0b\u56fe\u6240\u793a\uff1a"}),"\n",(0,d.jsx)(n.p,{children:(0,d.jsx)(n.img,{alt:"ts",src:s(90570).A+"",width:"2426",height:"2250"})}),"\n",(0,d.jsx)(n.h4,{id:"128-trng\u6a21\u5757",children:"1.2.8 TRNG\u6a21\u5757"}),"\n",(0,d.jsx)(n.p,{children:"TRNG \u96c6\u6210\u5728\u5b89\u5168\u6a21\u5757 PUF \u4e2d\uff0c\u4e3a\u6574\u4e2a SoC \u63d0\u4f9b\u771f\u968f\u673a\u6570\u529f\u80fd\uff0c\u4fdd\u62a4\u6839\u5bc6\u94a5\u548c\u542f\u52a8\u4ee3\u7801\u7b49\u5173\u952e\u6570\u636e\u4e0d\u88ab\u653b\u51fb\u8005\u7834\u574f\u3002\u5c0f\u6838\u4fa7 TRNG \u9a71\u52a8\u4e3b\u8981\u63d0\u4f9b\u8bfb\u529f\u80fd\uff0cTRNG \u9a71\u52a8\u6302\u8f7d\u5728 HW random \u6846\u67b6\u4e0a\uff0c\u5177\u4f53\u7684\u6846\u67b6\u7ed3\u6784\u5982\u4e0b\u56fe\u6240\u793a\uff1a"}),"\n",(0,d.jsx)(n.p,{children:(0,d.jsx)(n.img,{alt:"trng",src:s(70426).A+"",width:"2433",height:"1978"})}),"\n",(0,d.jsx)(n.h4,{id:"129-adc\u6a21\u5757",children:"1.2.9 ADC\u6a21\u5757"}),"\n",(0,d.jsx)(n.p,{children:"K230\u96c6\u6210\u4e00\u8defADC\u8f6c\u6362\u5668\uff0c\u51716\u5404\u901a\u9053\uff0c\u5206\u8fa8\u738712bit\uff0c\u6700\u9ad8\u6bcf\u79d21M\u6b21\u7684\u5355\u901a\u9053\u8fde\u7eed\u6a21\u6570\u8f6c\u6362\u3002"}),"\n",(0,d.jsx)(n.h4,{id:"1210-pwm\u6a21\u5757",children:"1.2.10 PWM\u6a21\u5757"}),"\n",(0,d.jsxs)(n.p,{children:["K230\u96c6\u6210\u4e862\u8defPWM\uff0c\u6bcf\u4e00\u8def\u67093\u5404\u901a\u9053\uff0c\u5373\u901a\u9053 0",(0,d.jsx)(n.del,{children:"2 \u5c5e\u4e8ePWM0\uff0c\u901a\u9053 3"}),"5 \u5c5e\u4e8ePWM1\uff08\u8f6f\u4ef6\u4e0a\u8868\u73b0\u4e3a\u901a\u9053 0~5 \uff09\uff0c\u6bcf\u4e00\u8def\u90fd\u53ef\u8f93\u51fa\u72ec\u7acb\u6ce2\u5f62\u3002"]}),"\n",(0,d.jsx)(n.h2,{id:"2-api\u53c2\u8003",children:"2 API\u53c2\u8003"}),"\n",(0,d.jsx)(n.h3,{id:"21-uart-api\u53c2\u8003",children:"2.1 UART API\u53c2\u8003"}),"\n",(0,d.jsx)(n.p,{children:"Linux\u5c01\u88c5\u4e86termios API\u7528\u6765\u7ed9\u7528\u6237\u4f7f\u7528\uff0ctermios API\u63cf\u8ff0\u4e86\u4e00\u4e2a\u901a\u7528\u7684\u7ec8\u7aef\u63a5\u53e3\uff0c\u63d0\u4f9b\u4e86\u63a7\u5236\u5f02\u6b65\u901a\u8baf\u7aef\u53e3\u7684\u914d\u7f6e\u548c\u8bfb\u5199\u3002"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-text",children:"termios API\u4e3e\u4f8b\uff1a\nint tcgetattr(int fd,struct termios *termios_p);\nint tcsetattr(int fd,int potional_actions,struct termios *termios_p);\nint tcsendbreak(int fd,int duration);\nint tcdrain(int fd);\nint tcflush(int fd, int queue_selector);\nint tcflow(int fd, int action);\nvoid cfmakeraw(struct termios *termios_p);\nspeed_t cfgetispeed(const struct termios *termios_p);\nspeed_t cfgetospeed(const struct termios *termios_p);\nint cfsetispeed(struct termios *termios_p, speed_t speed);\nint cfsetospeed(struct termios *termios_p, speed_t speed);\nint cfsetspeed(struct termios *termios_p, speed_t speed);\n"})}),"\n",(0,d.jsxs)(n.p,{children:["\u8be6\u7ec6\u8bf7\u53c2\u8003",(0,d.jsx)(n.code,{children:"Documentation/driver-api/serial/tty.rst"}),"\u3002"]}),"\n",(0,d.jsx)(n.h3,{id:"22-i2c-api\u53c2\u8003",children:"2.2 I2C API\u53c2\u8003"}),"\n",(0,d.jsx)(n.p,{children:"linux\u4e3a\u7528\u6237\u79f0\u5c01\u88c5\u4e86\u7cfb\u7edf\u8c03\u7528\u6765\u4f7f\u7528i2c\u3002"}),"\n",(0,d.jsx)(n.p,{children:(0,d.jsx)(n.a,{href:"#211-open",children:"open"})}),"\n",(0,d.jsx)(n.p,{children:(0,d.jsx)(n.a,{href:"#212-ioctl",children:"ioctl"})}),"\n",(0,d.jsx)(n.p,{children:(0,d.jsx)(n.a,{href:"#213-read",children:"read"})}),"\n",(0,d.jsx)(n.p,{children:(0,d.jsx)(n.a,{href:"#214-write",children:"write"})}),"\n",(0,d.jsx)(n.h3,{id:"23-gpio-api\u53c2\u8003",children:"2.3 GPIO API\u53c2\u8003"}),"\n",(0,d.jsx)(n.h4,{id:"231-sysfs\u63a7\u5236gpio",children:"2.3.1 sysfs\u63a7\u5236gpio"}),"\n",(0,d.jsxs)(n.p,{children:["GPIO\u9a71\u52a8\u52a0\u8f7d\u540e\u4f1a\u5728 ",(0,d.jsx)(n.code,{children:"/sys/class/gpio/"})," \u4e0b\u521b\u5efagpio\u7aef\u53e3\u7684\u8bbe\u5907\u8282\u70b9\uff0c\u6bcf\u4e2a\u8282\u70b9\u4ee3\u8868\u4e00\u4e2agpio\u7aef\u53e3\uff0c\u901a\u8fc7sysfs\u64cd\u4f5c\u8fd9\u4e2agpio\u7aef\u53e3\u5373\u53ef\u8fbe\u5230\u64cd\u4f5cgpio\u8f93\u5165\u8f93\u51fa\u548c\u4e2d\u65ad\u7684\u4f5c\u7528\u3002"]}),"\n",(0,d.jsx)(n.p,{children:"\u65b9\u6cd51\uff1a"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-text",children:"echo N > /sys/class/gpio/export        //\u5c06\u7f16\u53f7\u4e3a N \u7684gpio\u7aef\u53e3\u5bfc\u51fa\u5230sysfs\n\necho in > /sys/class/gpio/gpioN/direction    //\u5c06\u8be5gpio\u7aef\u53e3\u8bbe\u7f6e\u6210\u8f93\u5165\u6a21\u5f0f\n\ncat /sys/class/gpio/gpioN/value      //\u8bfb\u53d6\u8be5gpio\u7aef\u53e3\u7535\u5e73\u72b6\u6001\n\necho out > /sys/class/gpio/gpioN/direction    //\u5c06\u8be5gpio\u7aef\u53e3\u8bbe\u7f6e\u6210\u8f93\u51fa\u6a21\u5f0f\n\necho 1 > /sys/class/gpio/gpioN/value     //\u5c06\u8be5\u7aef\u53e3\u8f93\u51fa\u9ad8\u7535\u5e73\uff0c\u6ce8\u610factive_low\u6781\u6027\n\necho 0 > /sys/class/gpio/gpioN/value     //\u5c06\u8be5\u7aef\u53e3\u8f93\u51fa\u4f4e\u7535\u5e73\uff0c\u6ce8\u610factive_low\u6781\u6027\n\n\u8bbe\u7f6e\u4e2d\u65ad\u5c5e\u6027\uff1a\necho rising > /sys/class/gpio/gpioN/edge    \u4e0a\u5347\u6cbf\u4e2d\u65ad\uff0c\u4e2d\u65ad\u53ea\u80fd\u5728direction\u4e3ain\u65f6\u624d\u53ef\u4ee5\u8bbe\u7f6e\n\necho falling > /sys/class/gpio/gpioN/edge   \u4e0b\u964d\u6cbf\u4e2d\u65ad\n\necho both > /sys/class/gpio/gpioN/edge      \u53cc\u8fb9\u6cbf\u4e2d\u65ad\n"})}),"\n",(0,d.jsx)(n.p,{children:"\u65b9\u6cd52\uff1a"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-text",children:'\u8bbe\u7f6e\u597d\u4e2d\u65ad\u6a21\u5f0f\u540e\u901a\u8fc7poll\u51fd\u6570\u76d1\u542c\u4e2d\u65ad:\n\nstruct pollfd fds[1];\nfd = open("/sys/class/gpio/gpioN/value", O_RDONLY)\n\nfds[0].fd = gpio_fd;\nfds[0].events = POLLPRI;\n\nwhile(1)\n{\n    poll(fds, 1, -1);\n\n    if (fds[0].revents & POLLPRI)\n    {\n        /* \u63a5\u6536\u4e2d\u65ad */\n    }\n}\n\n'})}),"\n",(0,d.jsx)(n.h4,{id:"232-ioctl\u63a7\u5236gpio",children:"2.3.2 ioctl\u63a7\u5236gpio"}),"\n",(0,d.jsxs)(n.p,{children:["\u7528\u6237\u7a0b\u5e8f\u76f4\u63a5\u64cd\u4f5c ",(0,d.jsx)(n.code,{children:"/dev/gpiochipN"}),"\uff1a"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-text",children:'struct gpiohandle_request req;\nstruct gpiohandle_data data;\nstruct gpioevent_request event_req;\nstruct gpioevent_data event_data;\nstruct pollfd poll_fd;\nfd = open("/dev/gpiochipN", O_RDONLY);\n\n.....\n\nreq.lineoffsets[0] = 0;\nreq.flags = GPIOHANDLE_REQUEST_OUTPUT;\nreq.lines = 1;\n\nevent_req.lineoffset = 0;\nevent_req.handleflags = GPIOHANDLE_REQUEST_INPUT;\nevent_req.eventflags = GPIOEVENT_REQUEST_RISING_EDGE;\n\nioctl(fd, GPIO_GET_LINEHANDLE_IOCTL, &req);\nioctl(fd, GPIO_GET_LINEEVENT_IOCTL, &event_req);\n\nclose(fd);\n\npoll_fd.fd = event_req.fd;\npoll_fd.events = POLLIN;\n\nwhile(1)\n{\n    data.values[0] = !data.values[0];\n    .....\n    ioctl(req.fd, GPIOHANDLE_SET_LINE_VALUES_IOCTL, &data);\n    .....\n\n     ret = poll(&poll_fd, 1, 3000);\n     if(ret == 0)\n     ....\n     else {\n        read(event_req.fd, &event_data, sizeof(event_data));\n     }\n}\n\nclose(req.fd);\n\n'})}),"\n",(0,d.jsx)(n.h3,{id:"24-hardlock-api\u53c2\u8003",children:"2.4 Hardlock API\u53c2\u8003"}),"\n",(0,d.jsx)(n.p,{children:"Hardlock\u672a\u63d0\u4f9b\u7528\u6237api\u63a5\u53e3\uff0c\u5176\u4f7f\u7528\u65b9\u6cd5\u4ec5\u9650\u5185\u6838\u6001\u9a71\u52a8\u4e4b\u95f4\u4f7f\u7528\u3002"}),"\n",(0,d.jsx)(n.h3,{id:"25-wadtchdog-api\u53c2\u8003",children:"2.5 Wadtchdog API\u53c2\u8003"}),"\n",(0,d.jsx)(n.h4,{id:"251-\u901a\u8fc7ioctl\u4f7f\u7528watchdog",children:"2.5.1 \u901a\u8fc7ioctl\u4f7f\u7528watchdog"}),"\n",(0,d.jsx)(n.p,{children:(0,d.jsx)(n.a,{href:"#211-open",children:"open"})}),"\n",(0,d.jsx)(n.p,{children:(0,d.jsx)(n.a,{href:"#212-ioctl",children:"ioctl"})}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-text",children:'\u793a\u4f8b\uff1a\nfd = open("/dev/watchdog", O_WRONLY)\n\n.....\n\nioctl(fd, WDIOC_SETTIMEOUT, &flags); /* \u8bbe\u7f6e\u8d85\u65f6 */\n\nioctl(fd, WDIOC_GETTIMEOUT, &flags); /* \u83b7\u53d6\u8d85\u65f6\u8bbe\u7f6e */\n\nioctl(fd, WDIOC_SETPRETIMEOUT, &flags); /* \u8bbe\u7f6e\u9884\u8d85\u65f6 */\n\nioctl(fd, WDIOC_GETPRETIMEOUT, &flags); /* \u83b7\u53d6\u9884\u8d85\u65f6 */\n\nioctl(fd, WDIOC_GETTIMELEFT, &flags); /* \u83b7\u53d6\u5269\u4f59\u8d85\u65f6\u65f6\u95f4 */\n\nioctl(fd, WDIOC_KEEPALIVE, &dummy); /* \u5582\u72d7 */\n\n.....\n'})}),"\n",(0,d.jsx)(n.h4,{id:"252-\u901a\u8fc7\u6587\u4ef6\u7cfb\u7edf\u4f7f\u7528watchdog",children:"2.5.2 \u901a\u8fc7\u6587\u4ef6\u7cfb\u7edf\u4f7f\u7528watchdog"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-text",children:"echo V > /dev/watchdog     watchdog\u5f00\u59cb\u8ba1\u65f6\uff0c\u5185\u6838\u81ea\u52a8\u5582\u72d7\u7ebf\u7a0b\u542f\u52a8\n\necho A > /dev/watchdog     \u5185\u6838\u5582\u72d7\u7ebf\u7a0b\u505c\u6b62\u5582\u72d7\uff0c\u4f46\u8ba1\u65f6\u4ecd\u7136\u7ee7\u7eed\uff0c\u5728\u9ed8\u8ba4\u8d85\u65f6\u65f6\u95f4\u540e\u7cfb\u7edf\u590d\u4f4d\n"})}),"\n",(0,d.jsxs)(n.blockquote,{children:["\n",(0,d.jsx)(n.p,{children:"\u6ce8\u610f\uff1a\u5728\u547d\u4ee4\u884c\u5411watchdog\u8282\u70b9\u5199\u5b57\u7b26\u65f6\uff0cwatchdog\u88ab\u4f7f\u80fd\u5e76\u4f7f\u7528\u9ed8\u8ba4\u8d85\u65f6\u65f6\u95f4\u8ba1\u6570\uff0c\u4e14\u5185\u6838\u81ea\u52a8\u5582\u72d7\u7ebf\u7a0b\u88ab\u5524\u9192"}),"\n"]}),"\n",(0,d.jsx)(n.h3,{id:"26-otp-api-\u53c2\u8003",children:"2.6 OTP API \u53c2\u8003"}),"\n",(0,d.jsxs)(n.p,{children:["\u7528\u6237\u53ef\u901a\u8fc7 ",(0,d.jsx)(n.code,{children:"sysfs"})," \u6765\u8bbf\u95ee OTP \u786c\u4ef6\uff0c\u8fd8\u53ef\u4ee5\u901a\u8fc7\u8fd0\u884c\u7528\u6237\u6001\u7a0b\u5e8f\u8bfb\u53d6 OTP \u7a7a\u95f4\u3002"]}),"\n",(0,d.jsx)(n.h4,{id:"261-sysfs-\u6587\u4ef6\u7cfb\u7edf",children:"2.6.1 sysfs \u6587\u4ef6\u7cfb\u7edf"}),"\n",(0,d.jsxs)(n.p,{children:["Linux \u5185\u6838\u4f7f\u7528 ",(0,d.jsx)(n.code,{children:"sysfs"})," \u6587\u4ef6\u7cfb\u7edf\uff0c\u5b83\u7684\u4f5c\u7528\u662f\u5c06\u8bbe\u5907\u548c\u9a71\u52a8\u7a0b\u5e8f\u7684\u4fe1\u606f\u5bfc\u51fa\u5230\u7528\u6237\u7a7a\u95f4\uff0c\u65b9\u4fbf\u4e86\u7528\u6237\u8bfb\u53d6\u8bbe\u5907\u4fe1\u606f\uff0c\u540c\u65f6\u652f\u6301\u4fee\u6539\u548c\u8c03\u6574\u3002",(0,d.jsx)(n.code,{children:"Sysfs"})," \u865a\u62df\u6587\u4ef6\u7cfb\u7edf\u4e00\u822c\u88ab\u6302\u8f7d\u5728 ",(0,d.jsx)(n.code,{children:"/sys"})," \u76ee\u5f55\u4e0b\u3002OTP \u4e00\u65e6\u88ab\u6ce8\u518c\u5230 Linux \u4e2d\u7684 ",(0,d.jsx)(n.code,{children:"NVMEM"})," \u6846\u67b6\u4e2d\u4e4b\u540e\uff0c\u901a\u8fc7 ",(0,d.jsx)(n.code,{children:"sysfs"})," \u865a\u62df\u6587\u4ef6\u7cfb\u7edf\uff0c\u53ef\u4ee5\u5f88\u5bb9\u6613\u67e5\u770b\u5230 OTP \u7684\u4fe1\u606f\u3002"]}),"\n",(0,d.jsxs)(n.p,{children:["OTP sysfs\u4f4d\u4e8e ",(0,d.jsx)(n.code,{children:"/sys/bus/nvmem/devices/kendryte_otp0/"})," \u76ee\u5f55\u4e0b\uff0c\u6587\u4ef6\u7ed3\u6784\u5982\u4e0b\uff1a"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-shell",children:".\n|-- nvmem\n|-- of_node -> ../../../../../../firmware/devicetree/base/soc/security/otp@91214000\n|-- subsystem -> ../../../../../../bus/nvmem\n|-- type\n|-- uevent\n\n"})}),"\n",(0,d.jsx)(n.p,{children:"\u542f\u52a8 Linux \u4e4b\u540e\uff0c\u8fd0\u884c\u4e0b\u5217\u547d\u4ee4\uff1a"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-shell",children:"[root@canaan ~ ]# hexdump -C -v /sys/bus/nvmem/devices/kendryte_otp0/nvmem\n00000000  ff ff ff ff ff ff ff ff  ff ff ff ff ff ff ff ff  |................|\n00000010  ff ff ff ff ff ff ff ff  ff ff ff ff ff ff ff ff  |................|\n00000020  ff ff ff ff ff ff ff ff  ff ff ff ff ff ff ff ff  |................|\n00000030  ff ff ff ff ff ff ff ff  ff ff ff ff ff ff ff ff  |................|\n00000040  ff ff ff ff ff ff ff ff  ff ff ff ff ff ff ff ff  |................|\n00000050  ff ff ff ff ff ff ff ff  ff ff ff ff ff ff ff ff  |................|\n00000060  ff ff ff ff ff ff ff ff  ff ff ff ff ff ff ff ff  |................|\n00000070  ff ff ff ff ff ff ff ff  ff ff ff ff ff ff ff ff  |................|\n00000080  00 02 00 00 50 02 00 00  00 01 00 00 00 00 00 00  |....P...........|\n00000090  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|\n000000a0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|\n......\n\n"})}),"\n",(0,d.jsxs)(n.p,{children:["\u6216\u8005\uff0c\u5229\u7528 ",(0,d.jsx)(n.code,{children:"dd"})," \u547d\u4ee4\uff1a"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-shell",children:"[root@canaan ~ ]# dd if=/sys/bus/nvmem/devices/kendryte_otp0/nvmem of=/tmp/file\n6+0 records in\n6+0 records out\n[root@canaan ~ ]# hexdump -C -v /tmp/file\n00000000  ff ff ff ff ff ff ff ff  ff ff ff ff ff ff ff ff  |................|\n00000010  ff ff ff ff ff ff ff ff  ff ff ff ff ff ff ff ff  |................|\n00000020  ff ff ff ff ff ff ff ff  ff ff ff ff ff ff ff ff  |................|\n00000030  ff ff ff ff ff ff ff ff  ff ff ff ff ff ff ff ff  |................|\n00000040  ff ff ff ff ff ff ff ff  ff ff ff ff ff ff ff ff  |................|\n00000050  ff ff ff ff ff ff ff ff  ff ff ff ff ff ff ff ff  |................|\n00000060  ff ff ff ff ff ff ff ff  ff ff ff ff ff ff ff ff  |................|\n00000070  ff ff ff ff ff ff ff ff  ff ff ff ff ff ff ff ff  |................|\n00000080  00 02 00 00 50 02 00 00  00 01 00 00 00 00 00 00  |....P...........|\n00000090  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|\n......\n\n"})}),"\n",(0,d.jsx)(n.h4,{id:"262-\u7528\u6237\u6001\u8bbf\u95ee-otp",children:"2.6.2 \u7528\u6237\u6001\u8bbf\u95ee OTP"}),"\n",(0,d.jsx)(n.p,{children:"\u7f16\u5199\u4e00\u4e2a\u7528\u6237\u6001\u5e94\u7528\u7a0b\u5e8f\uff0c\u7528\u6237\u6001\u5e94\u7528\u7a0b\u5e8f\u901a\u8fc7\u6807\u51c6\u7684\u7cfb\u7edf\u8c03\u7528open()\u3001close()\u3001read()\u7b49\u51fd\u6570\u9677\u5165\u5230\u5185\u6838\u6001\uff0c\u6700\u7ec8\u4f1a\u8c03\u7528 OTP \u9a71\u52a8\u4e2d\u6ce8\u518c\u7684\u63a5\u53e3\u4e2d\uff0c\u4ee5\u6d4b\u8bd5 OTP \u529f\u80fd\u3002"}),"\n",(0,d.jsxs)(n.p,{children:["\u76ee\u524d\u7528\u6237\u6001\u5e94\u7528\u7a0b\u5e8f\u5df2\u7ecf\u7f16\u5199\u5b8c\u6210\uff0c\u751f\u6210\u7684\u53ef\u6267\u884c\u6587\u4ef6\u5728 ",(0,d.jsx)(n.code,{children:"/usr/bin/otp_test_demo"})," \u76ee\u5f55\u4e0b\u3002"]}),"\n",(0,d.jsx)(n.p,{children:"\u8fd0\u884c\u6b65\u9aa4\u5982\u4e0b\uff1a"}),"\n",(0,d.jsxs)(n.ol,{children:["\n",(0,d.jsx)(n.li,{children:"\u8fdb\u5165\u5e94\u7528\u7a0b\u5e8f demo \u76ee\u5f55\uff1b"}),"\n",(0,d.jsx)(n.li,{children:"\u5728 demo \u76ee\u5f55\u4e0b\u8fd0\u884c otp demo\uff0c\u8bfb\u53d6\u957f\u5ea6\u4f5c\u4e3a\u53c2\u6570\uff1b"}),"\n",(0,d.jsx)(n.li,{children:"\u6267\u884c otp demo\u3002"}),"\n",(0,d.jsx)(n.li,{children:"\u6539\u53d8\u8bfb\u53d6\u957f\u5ea6\uff08\u957f\u5ea6\u8303\u56f4\uff1a1~768\uff09\uff0c\u91cd\u65b0\u6267\u884c otp demo\u3002"}),"\n"]}),"\n",(0,d.jsx)(n.p,{children:"\u542f\u52a8\u5c0f\u6838Linux\u4e4b\u540e\uff0c\u8fd0\u884c\u4e0b\u5217\u547d\u4ee4\uff1a"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-shell",children:"[root@canaan ~ ]#cd /usr/bin/\n[root@canaan /usr/bin ]# ./otp_test_demo 768\nAddr                    Value\n00000000                0xffffffff\n00000004                0xffffffff\n00000008                0xffffffff\n0000000c                0xffffffff\n00000010                0xffffffff\n00000014                0xffffffff\n00000018                0xffffffff\n0000001c                0xffffffff\n00000020                0xffffffff\n00000024                0xffffffff\n00000028                0xffffffff\n0000002c                0xffffffff\n00000030                0xffffffff\n00000034                0xffffffff\n00000038                0xffffffff\n0000003c                0xffffffff\n00000040                0xffffffff\n......\n\n"})}),"\n",(0,d.jsx)(n.h4,{id:"263-otp-\u7a7a\u95f4\u9ed8\u8ba4\u503c",children:"2.6.3 OTP \u7a7a\u95f4\u9ed8\u8ba4\u503c"}),"\n",(0,d.jsx)(n.p,{children:"OTP \u7a7a\u95f4\u9ed8\u8ba4\u503c\u4fe1\u606f\u5982\u4e0b\u6240\u793a\uff0c\u8bf7\u5bf9\u7167\u9ed8\u8ba4\u503c\u9a8c\u8bc1\u8bfb\u53d6OTP\u7a7a\u95f4\u662f\u5426\u6b63\u786e\u3002"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-text",children:'00000000  ff ff ff ff ff ff ff ff  ff ff ff ff ff ff ff ff  |................|\n*\n00000080  00 02 00 00 50 02 00 00  00 01 00 00 00 00 00 00  |....P...........|\n00000090  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|\n*\n00000100  8d 3d da 24 1c f6 fa f6  88 4b c3 91 fb 2d 7b 09  |.=.$.....K...-{.|\n00000110  a6 64 03 7d ce 98 e0 d2  92 5a a0 cf 3c 58 50 d0  |.d.}.....Z..<XP.|\n00000120  3b 77 37 e6 0d 36 eb 9a  21 42 a1 2a 53 d8 aa 87  |;w7..6..!B.*S...|\n00000130  ab 53 5c e7 ab 3e 7a c6  f4 29 16 71 45 f1 30 0d  |.S\\..>z..).qE.0.|\n00000140  91 3f a6 3d 48 30 dd 6d  18 c2 1c 13 97 fe 1f 9b  |.?.=H0.m........|\n00000150  fd 08 1c 16 1b a7 9a 20  1d 80 70 8a 20 08 61 a3  |....... ..p. .a.|\n00000160  24 2b cf ec 97 9e 3f 25  89 b9 f2 a8 7a 63 5c c7  |$+....?%....zc\\.|\n00000170  44 86 70 30 45 e4 4f 35  4d 2e 3e 8c e5 3a 49 29  |D.p0E.O5M.>..:I)|\n00000180  b6 06 6e 15 6b 62 d3 94  5f 8a ea e3 ea a3 a1 fc  |..n.kb.._.......|\n00000190  0f 19 f5 50 05 4d 63 47  77 14 c1 c0 bf 06 3b 55  |...P.McGw.....;U|\n000001a0  47 be 7c c6 93 e2 e1 31  05 27 f5 a2 77 16 1f 75  |G.|....1.\'..w..u|\n000001b0  5a 95 0a 15 24 16 a8 1a  fc d8 67 f4 dd 15 e4 8c  |Z...$.....g.....|\n000001c0  25 44 b9 48 59 b1 17 bb  8e 05 15 db ff fa 77 47  |%D.HY.........wG|\n000001d0  52 ce f7 86 bf 20 b5 46  ac 83 e9 ac 08 a7 e3 67  |R.... .F.......g|\n000001e0  02 24 50 de 49 9d 24 57  9f 78 bb 74 21 8f 74 f0  |.$P.I.$W.x.t!.t.|\n000001f0  47 25 9b cb 99 e7 6a 0f  51 52 be 4b ea 6a a3 ee  |G%....j.QR.K.j..|\n00000200  7b 8d f8 ad c8 c6 5e c4  13 66 4b 50 3b 02 98 c8  |{.....^..fKP;...|\n00000210  20 11 c5 ca 54 ee 32 ea  89 e4 38 58 cd 5a cb 34  | ...T.2...8X.Z.4|\n00000220  2f d2 d9 b3 d9 97 50 a8  10 74 73 17 b0 76 19 ec  |/.....P..ts..v..|\n00000230  8e 1e 07 58 ba f5 5b b9  a3 6e 0b f8 ae 8c ba 35  |...X..[..n.....5|\n00000240  53 6b 5d 52 9d e9 76 46  ae f7 1f 8d 45 b4 93 b6  |Sk]R..vF....E...|\n00000250  28 93 b4 07 6f 8e be 37  41 57 86 19 c1 d0 fb 9b  |(...o..7AW......|\n00000260  8e 09 7a 77 a4 23 83 db  39 64 6c 5f 73 0d 82 2e  |..zw.#..9dl_s...|\n00000270  ca 5b 2e c4 5f b0 6b 23  3d fd 96 88 e8 b9 e9 02  |.[.._.k#=.......|\n00000280  a8 e1 22 b1 c4 af 61 4c  bc ab 93 a1 d1 80 aa 6f  |.."...aL.......o|\n00000290  01 dc cd c1 a0 71 36 58  86 ed 7e d9 c1 15 95 50  |.....q6X..~....P|\n000002a0  f2 4e 9a 0e c9 d8 58 d6  14 93 c9 de 86 0e 87 52  |.N....X........R|\n000002b0  85 e6 ff d6 28 e8 dd 29  5a ab b4 b3 ce de 35 e9  |....(..)Z.....5.|\n000002c0  48 f2 1f a8 22 8f e3 17  d7 86 d8 e8 de 24 4d 2a  |H..."........$M*|\n000002d0  70 89 37 47 9c 53 9b 33  0b 74 95 30 d6 4e e0 36  |p.7G.S.3.t.0.N.6|\n000002e0  bc 10 ff da ab bd 74 e7  df 04 08 11 e7 43 94 09  |......t......C..|\n000002f0  4d 74 df 13 84 a0 86 54  4c d0 cb c2 63 fb 42 7d  |Mt.....TL...c.B}|\n00000300  5b e6 9d 3b dc 86 59 d7  cb df 29 65 53 51 54 8b  |[..;..Y...)eSQT.|\n00000310  b1 50 96 a2 85 e0 b6 b4  d2 ce 6d 63 48 09 b3 62  |.P........mcH..b|\n00000320  9d f5 d4 16 4c 81 5f b4  e1 f7 91 7b 5f 7f c9 29  |....L._....{_..)|\n00000330  43 22 56 e8 f5 ae 68 b3  a0 a8 f9 7d 7b d9 b1 2e  |C"V...h....}{...|\n00000340  98 25 07 7b 38 33 9c 99  f6 85 c7 49 cb dc 6f 1d  |.%.{83.....I..o.|\n00000350  1c 45 d1 ff 57 a4 b9 d7  2a 6c 3f 9e dd 9a ee 5b  |.E..W...*l?....[|\n00000360  f3 0b 21 af 2e d8 e5 ce  4f b7 4d 07 ea ba 5a e9  |..!.....O.M...Z.|\n00000370  df 85 d8 6d 88 78 84 9a  dd 1a 4a 4a 86 2e e4 62  |...m.x....JJ...b|\n00000380  c2 94 4c e7 77 0b 2c 7a  38 03 2c 2a a1 f7 5b dd  |..L.w.,z8.,*..[.|\n00000390  14 a7 d8 4a 66 38 d0 9f  e8 28 a8 7c 33 36 39 72  |...Jf8...(.|369r|\n000003a0  1b 7b 84 68 a6 a8 dd 7e  a9 5b f0 8e 2b 50 6e 40  |.{.h...~.[..+Pn@|\n000003b0  d2 a5 62 43 5e f1 f4 bf  90 11 0f e2 16 b5 80 4e  |..bC^..........N|\n000003c0  10 68 a7 a2 aa 2d dd ba  c1 d7 d6 0c b7 17 a5 a3  |.h...-..........|\n000003d0  c2 e2 77 e8 7c 9a ff 23  8c 30 ae b3 5a 79 1c fd  |..w.|..#.0..Zy..|\n000003e0  77 4a f6 41 78 53 36 52  d4 45 a6 f9 c2 8e 8d fc  |wJ.AxS6R.E......|\n000003f0  03 2e f4 00 58 e8 15 85  bf d9 3f b8 62 58 e2 97  |....X.....?.bX..|\n00000400  d2 ea 7f b2 a2 ef 40 f2  fc 68 07 64 51 f7 c9 6e  |......@..h.dQ..n|\n00000410  68 eb 68 ec 15 a8 a7 7e  1d 86 8b 12 f1 33 a0 18  |h.h....~.....3..|\n00000420  21 06 f4 0a 58 4b ec 17  7d 87 2c ec ea ce 3e ce  |!...XK..}.,...>.|\n00000430  02 2f 02 a5 76 61 57 dd  85 6e f5 14 d4 6b fb f9  |./..vaW..n...k..|\n00000440  64 d3 60 2c 1f 45 00 9c  50 d4 2a aa 1d f0 96 82  |d.`,.E..P.*.....|\n00000450  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|\n*\n00000bf0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|\n\n'})}),"\n",(0,d.jsx)(n.h3,{id:"27-ts-api-\u53c2\u8003",children:"2.7 TS API \u53c2\u8003"}),"\n",(0,d.jsxs)(n.p,{children:["\u7528\u6237\u53ef\u901a\u8fc7 ",(0,d.jsx)(n.code,{children:"sysfs"})," \u6765\u8bbf\u95ee TS \u786c\u4ef6\uff0c\u8fd8\u53ef\u4ee5\u901a\u8fc7\u8fd0\u884c\u7528\u6237\u6001\u7a0b\u5e8f\u8bfb\u53d6\u82af\u7247\u7ed3\u6e29\u3002"]}),"\n",(0,d.jsx)(n.h4,{id:"271-sysfs-\u6587\u4ef6\u7cfb\u7edf",children:"2.7.1 sysfs \u6587\u4ef6\u7cfb\u7edf"}),"\n",(0,d.jsxs)(n.p,{children:["Linux \u5185\u6838\u4f7f\u7528 ",(0,d.jsx)(n.code,{children:"sysfs"})," \u6587\u4ef6\u7cfb\u7edf\uff0c\u5b83\u7684\u4f5c\u7528\u662f\u5c06\u8bbe\u5907\u548c\u9a71\u52a8\u7a0b\u5e8f\u7684\u4fe1\u606f\u5bfc\u51fa\u5230\u7528\u6237\u7a7a\u95f4\uff0c\u65b9\u4fbf\u4e86\u7528\u6237\u8bfb\u53d6\u8bbe\u5907\u4fe1\u606f\uff0c\u540c\u65f6\u652f\u6301\u4fee\u6539\u548c\u8c03\u6574\u3002",(0,d.jsx)(n.code,{children:"sysfs"})," \u865a\u62df\u6587\u4ef6\u7cfb\u7edf\u4e00\u822c\u88ab\u6302\u8f7d\u5728 ",(0,d.jsx)(n.code,{children:"/sys"})," \u76ee\u5f55\u4e0b\u3002TS \u4e00\u65e6\u88ab\u6ce8\u518c\u5230 Linux \u4e2d\u7684 Thermal \u6846\u67b6\u4e2d\u4e4b\u540e\uff0c\u901a\u8fc7 ",(0,d.jsx)(n.code,{children:"sysfs"})," \u865a\u62df\u6587\u4ef6\u7cfb\u7edf\uff0c\u53ef\u4ee5\u5f88\u5bb9\u6613\u67e5\u770b\u5230 TS \u7684\u4fe1\u606f\u3002"]}),"\n",(0,d.jsxs)(n.p,{children:["TS sysfs\u4f4d\u4e8e ",(0,d.jsx)(n.code,{children:"/sys/class/thermal/thermal_zone0/"})," \u76ee\u5f55\u4e0b\uff0c\u6587\u4ef6\u7ed3\u6784\u5982\u4e0b\uff1a"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-shell",children:".\n|-- available_policies\n|-- integral_cutoff\n|-- k_d\n|-- k_i\n|-- k_po\n|-- k_pu\n|-- mode\n|-- offset\n|-- passive\n|-- policy\n|-- slope\n|-- subsystem -> ../../../../class/thermal\n|-- sustainable_power\n|-- temp\n|-- type\n|-- uevent\n\n"})}),"\n",(0,d.jsx)(n.p,{children:"\u542f\u52a8 Linux \u4e4b\u540e\uff0c\u8fd0\u884c\u4e0b\u5217\u547d\u4ee4\uff1a"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-shell",children:"[root@canaan ~ ]#cat /sys/class/thermal/thermal_zone0/temp\n7182\n......\n\n"})}),"\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.code,{children:"7182"})," \u8fd9\u4e2a\u503c\u8868\u793a\u7684\u542b\u4e49\u4e3a\uff1a\u8bfb\u53d6 tsensor \u5bc4\u5b58\u5668\u7684\u503c\uff0c\u5e76\u6ca1\u6709\u505a\u4efb\u4f55\u6570\u5b66\u8fd0\u7b97\u3002\u76f8\u5e94\u7684\u6570\u5b66\u8868\u8fbe\u5f0f\u5982\u4e0b:"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-text",children:"\ncode = ts_val & 0xfff;\ntemp = (1e-10 * pow(code, 4) * 1.01472 - 1e-6 * pow(code, 3) * 1.10063 + 4.36150 * 1e-3 * pow(code, 2) - 7.10128 * code + 3565.87);\n\n"})}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:"ts_val\uff1a\u5b9e\u9645\u8bfb\u53d6 TS \u5bc4\u5b58\u5668\u7684\u503c\uff1b"}),"\n",(0,d.jsx)(n.li,{children:"code\uff1aTS \u5bc4\u5b58\u5668\u7684\u503c\u4fdd\u7559\u4f4e12\u4f4d\u5f97\u5230\u7684\u7ed3\u679c\uff1b"}),"\n",(0,d.jsx)(n.li,{children:"temp\uff1a\u8ba1\u7b97\u5f97\u5230\u7684\u6e29\u5ea6\u503c\u3002"}),"\n"]}),"\n",(0,d.jsx)(n.h4,{id:"272-\u7528\u6237\u6001\u8bbf\u95ee-ts",children:"2.7.2 \u7528\u6237\u6001\u8bbf\u95ee TS"}),"\n",(0,d.jsx)(n.p,{children:"\u7f16\u5199\u4e00\u4e2a\u7528\u6237\u6001\u5e94\u7528\u7a0b\u5e8f\uff0c\u7528\u6237\u6001\u5e94\u7528\u7a0b\u5e8f\u901a\u8fc7\u6807\u51c6\u7684\u7cfb\u7edf\u8c03\u7528open()\u3001close()\u3001read()\u7b49\u51fd\u6570\u9677\u5165\u5230\u5185\u6838\u6001\uff0c\u6700\u7ec8\u4f1a\u8c03\u7528 TS \u9a71\u52a8\u4e2d\u6ce8\u518c\u7684\u63a5\u53e3\u4e2d\uff0c\u4ee5\u6d4b\u8bd5 TS \u529f\u80fd\u3002"}),"\n",(0,d.jsxs)(n.p,{children:["\u76ee\u524d\u7528\u6237\u6001\u5e94\u7528\u7a0b\u5e8f\u5df2\u7ecf\u7f16\u5199\u5b8c\u6210\uff0c\u751f\u6210\u7684\u53ef\u6267\u884c\u6587\u4ef6\u5728 ",(0,d.jsx)(n.code,{children:"/usr/bin/ts_test_demo"})," \u76ee\u5f55\u4e0b\u3002"]}),"\n",(0,d.jsx)(n.p,{children:"\u8fd0\u884c\u6b65\u9aa4\u5982\u4e0b\uff1a"}),"\n",(0,d.jsxs)(n.ol,{children:["\n",(0,d.jsx)(n.li,{children:"\u8fdb\u5165\u5e94\u7528\u7a0b\u5e8f demo \u76ee\u5f55\uff1b"}),"\n",(0,d.jsx)(n.li,{children:"\u5728 demo \u76ee\u5f55\u4e0b\u8fd0\u884c ts demo\uff0c\u5faa\u73af\u6b21\u6570\u4f5c\u4e3a\u53c2\u6570\uff1b"}),"\n",(0,d.jsx)(n.li,{children:"\u6267\u884c ts demo\u3002"}),"\n",(0,d.jsx)(n.li,{children:"\u6539\u53d8\u5faa\u73af\u6b21\u6570\uff0c\u91cd\u65b0\u6267\u884c ts demo\u3002"}),"\n"]}),"\n",(0,d.jsx)(n.p,{children:"\u542f\u52a8\u5c0f\u6838Linux\u4e4b\u540e\uff0c\u8fd0\u884c\u4e0b\u5217\u547d\u4ee4\uff1a"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-shell",children:"[root@canaan ~ ]#cd /usr/bin/\n[root@canaan /usr/bin ]#./ts_test_demo 5\nts_val: 0x1c08, TS = 42.176993 C\nts_val: 0x1c07, TS = 41.875168 C\nts_val: 0x1c06, TS = 41.573277 C\nts_val: 0x1c07, TS = 41.875168 C\nts_val: 0x1c0a, TS = 42.780447 C\n[root@canaan ~ ]#\n\n"})}),"\n",(0,d.jsx)(n.h3,{id:"28-trng-api-\u53c2\u8003",children:"2.8 TRNG API \u53c2\u8003"}),"\n",(0,d.jsxs)(n.p,{children:["\u7528\u6237\u53ef\u901a\u8fc7 ",(0,d.jsx)(n.code,{children:"sysfs"})," \u6765\u8bbf\u95ee TRNG \u786c\u4ef6\uff0c\u8fd8\u53ef\u4ee5\u901a\u8fc7\u8fd0\u884c\u7528\u6237\u6001\u7a0b\u5e8f\u8bfb\u53d6\u771f\u968f\u673a\u6570\u3002"]}),"\n",(0,d.jsx)(n.h4,{id:"281-sysfs-\u6587\u4ef6\u7cfb\u7edf",children:"2.8.1 sysfs \u6587\u4ef6\u7cfb\u7edf"}),"\n",(0,d.jsxs)(n.p,{children:["Linux \u5185\u6838\u4f7f\u7528 ",(0,d.jsx)(n.code,{children:"sysfs"})," \u6587\u4ef6\u7cfb\u7edf\uff0c\u5b83\u7684\u4f5c\u7528\u662f\u5c06\u8bbe\u5907\u548c\u9a71\u52a8\u7a0b\u5e8f\u7684\u4fe1\u606f\u5bfc\u51fa\u5230\u7528\u6237\u7a7a\u95f4\uff0c\u65b9\u4fbf\u4e86\u7528\u6237\u8bfb\u53d6\u8bbe\u5907\u4fe1\u606f\uff0c\u540c\u65f6\u652f\u6301\u4fee\u6539\u548c\u8c03\u6574\u3002",(0,d.jsx)(n.code,{children:"sysfs"})," \u865a\u62df\u6587\u4ef6\u7cfb\u7edf\u4e00\u822c\u88ab\u6302\u8f7d\u5728 ",(0,d.jsx)(n.code,{children:"/sys"})," \u76ee\u5f55\u4e0b\u3002TRNG \u4e00\u65e6\u88ab\u6ce8\u518c\u5230 Linux \u4e2d\u7684 HW random \u6846\u67b6\u4e2d\u4e4b\u540e\uff0c\u901a\u8fc7 ",(0,d.jsx)(n.code,{children:"sysfs"})," \u865a\u62df\u6587\u4ef6\u7cfb\u7edf\uff0c\u53ef\u4ee5\u5f88\u5bb9\u6613\u67e5\u770b\u5230 TRNG \u7684\u4fe1\u606f\u3002"]}),"\n",(0,d.jsxs)(n.p,{children:["TRNG sysfs\u4f4d\u4e8e ",(0,d.jsx)(n.code,{children:"/sys/class/misc/hw_random/"})," \u76ee\u5f55\u4e0b\uff0c\u6587\u4ef6\u7ed3\u6784\u5982\u4e0b\uff1a"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-shell",children:".\n|-- dev\n|-- rng_available\n|-- rng_current\n|-- rng_selected\n|-- subsystem -> ../../../../class/misc\n|-- uevent\n\n"})}),"\n",(0,d.jsx)(n.p,{children:"\u542f\u52a8 Linux \u4e4b\u540e\uff0c\u8fd0\u884c\u4e0b\u5217\u547d\u4ee4\uff1a"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-shell",children:"[root@canaan ~ ]# cat /sys/class/misc/hw_random/rng_current\n91213000.trng\n[root@canaan ~ ]# cat /sys/class/misc/hw_random/rng_available\n91213000.trng\n\n"})}),"\n",(0,d.jsx)(n.h4,{id:"282-\u7528\u6237\u6001\u8bbf\u95ee-trng",children:"2.8.2 \u7528\u6237\u6001\u8bbf\u95ee TRNG"}),"\n",(0,d.jsx)(n.p,{children:"\u7f16\u5199\u4e00\u4e2a\u7528\u6237\u6001\u5e94\u7528\u7a0b\u5e8f\uff0c\u7528\u6237\u6001\u5e94\u7528\u7a0b\u5e8f\u901a\u8fc7\u6807\u51c6\u7684\u7cfb\u7edf\u8c03\u7528open()\u3001close()\u3001read()\u7b49\u51fd\u6570\u9677\u5165\u5230\u5185\u6838\u6001\uff0c\u6700\u7ec8\u4f1a\u8c03\u7528 TRNG \u9a71\u52a8\u4e2d\u6ce8\u518c\u7684\u63a5\u53e3\u4e2d\uff0c\u67e5\u770b\u6bcf\u6b21\u8bfb\u53d6\u5f97\u5230\u7684\u6570\u636e\u662f\u5426\u4e0d\u4e00\u81f4\uff0c\u4ece\u800c\u6d4b\u8bd5 TRNG \u7684\u529f\u80fd\u3002"}),"\n",(0,d.jsxs)(n.p,{children:["\u76ee\u524d\u7528\u6237\u6001\u5e94\u7528\u7a0b\u5e8f\u5df2\u7ecf\u7f16\u5199\u5b8c\u6210\uff0c\u751f\u6210\u7684\u53ef\u6267\u884c\u6587\u4ef6\u5728 ",(0,d.jsx)(n.em,{children:"/usr/bin/trng_test_demo"})," \u76ee\u5f55\u4e0b\u3002"]}),"\n",(0,d.jsx)(n.p,{children:"\u8fd0\u884c\u6b65\u9aa4\u5982\u4e0b\uff1a"}),"\n",(0,d.jsxs)(n.ol,{children:["\n",(0,d.jsx)(n.li,{children:"\u8fdb\u5165\u5e94\u7528\u7a0b\u5e8f demo \u76ee\u5f55\uff1b"}),"\n",(0,d.jsx)(n.li,{children:"\u5728 demo \u76ee\u5f55\u4e0b\u8fd0\u884c trng demo\uff1b"}),"\n",(0,d.jsx)(n.li,{children:"\u6267\u884c trng demo\u3002"}),"\n",(0,d.jsx)(n.li,{children:"\u91cd\u590d\u6267\u884c trng demo\uff0c\u67e5\u770b\u6bcf\u6b21\u8bfb\u53d6\u7684\u968f\u673a\u6570\u662f\u5426\u4e00\u81f4\u3002"}),"\n"]}),"\n",(0,d.jsx)(n.p,{children:"\u542f\u52a8\u5c0f\u6838Linux\u4e4b\u540e\uff0c\u8fd0\u884c\u4e0b\u5217\u547d\u4ee4\uff1a"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-text",children:"[root@canaan ~ ]#cd /usr/bin/\n[root@canaan /usr/bin ]#./trng_test_demo\n2C 10 B3 29 C3 98 10 41 3C 2A 90 75 EB C4 61 A5\n[root@canaan /usr/bin ]#./trng_test_demo\n6E AB 46 DD C1 7D FC 97 65 02 0C 58 1E A1 80 B9\n[root@canaan ~ ]#\n\n"})}),"\n",(0,d.jsx)(n.p,{children:"\u9ed8\u8ba4\u6bcf\u6b21\u6253\u537016\u4e2a\u5b57\u8282\u7684\u968f\u673a\u6570\uff0c\u6bcf\u6b21\u6253\u5370\u7684\u968f\u673a\u6570\u4e0d\u540c\u3002"}),"\n",(0,d.jsx)(n.h3,{id:"29-adc-api\u53c2\u8003",children:"2.9 ADC API\u53c2\u8003"}),"\n",(0,d.jsxs)(n.p,{children:["\u7528\u6237\u53ef\u901a\u8fc7 ",(0,d.jsx)(n.code,{children:"sysfs"})," \u6765\u8bbf\u95ee ADC \u5404\u901a\u9053\uff0c\u8fd8\u53ef\u4ee5\u901a\u8fc7\u8fd0\u884c\u7528\u6237\u6001\u7a0b\u5e8f\u8bfb\u53d6\u5404\u901a\u9053\u7535\u538b\u8f6c\u6362\u6570\u636e\u3002"]}),"\n",(0,d.jsx)(n.h4,{id:"291-sysfs\u8bbf\u95ee-adc",children:"2.9.1 sysfs\u8bbf\u95ee ADC"}),"\n",(0,d.jsxs)(n.p,{children:["Linux\u4e0bADC\u662f\u6302\u8f7d\u5728IIO\u5b50\u7cfb\u7edf\u4e0b\u7684\uff0c\u901a\u8fc7",(0,d.jsx)(n.code,{children:"sysfs"}),"\u8bbf\u95ee\u53ef\u4ee5\u53c2\u8003\u5982\u4e0b\u793a\u4f8b\uff1b"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-shell",children:"1\u3001cd /sys/devices/platform/soc/9140d000.adc/iio:device0\n2\u3001cat in_voltage0_raw   \u8bfb\u53d6\u901a\u90530\n3\u3001cat in_voltage1_raw   \u8bfb\u53d6\u901a\u90531\n4\u3001cat in_voltage2_raw   \u8bfb\u53d6\u901a\u90532\n5\u3001cat in_voltage3_raw   \u8bfb\u53d6\u901a\u90533\n6\u3001cat in_voltage4_raw   \u8bfb\u53d6\u901a\u90534\n7\u3001cat in_voltage5_raw   \u8bfb\u53d6\u901a\u90535\n"})}),"\n",(0,d.jsx)(n.p,{children:"\u6ce8\u610f\uff1a\u5728\u5609\u6960 K230_EVB \u5f00\u53d1\u677f\u4e0a\uff0cADC\u901a\u90535\u53e6\u4e00\u7aef\u5df2\u7ecf\u63a5\u5728\u97f3\u9891\u8f93\u51fa\u63a5\u53e3\u4e0a\uff0c\u6240\u4ee5\u4e0d\u5efa\u8bae\u5c06\u6b64\u901a\u9053\u7528\u4f5c\u4ed6\u7528\u3002"}),"\n",(0,d.jsx)(n.h4,{id:"292-\u7528\u6237\u6001\u8bbf\u95ee-adc",children:"2.9.2 \u7528\u6237\u6001\u8bbf\u95ee ADC"}),"\n",(0,d.jsx)(n.p,{children:"\u7565\u3002"}),"\n",(0,d.jsx)(n.h3,{id:"210-pwm-api\u53c2\u8003",children:"2.10 PWM API\u53c2\u8003"}),"\n",(0,d.jsxs)(n.p,{children:["\u7528\u6237\u53ef\u901a\u8fc7 ",(0,d.jsx)(n.code,{children:"sysfs"})," \u6765\u8bbf\u95ee PWM \u5404\u901a\u9053\uff0c\u8fd8\u53ef\u4ee5\u901a\u8fc7\u8fd0\u884c\u7528\u6237\u6001\u7a0b\u5e8f\u63a7\u5236\u5404\u901a\u9053\u8f93\u51fa\u6ce2\u5f62\u5468\u671f\u53ca\u5360\u7a7a\u6bd4\u3002"]}),"\n",(0,d.jsx)(n.h4,{id:"2101-sysfs\u8bbf\u95ee-pwm",children:"2.10.1 sysfs\u8bbf\u95ee PWM"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-shell",children:"1\u3001cd /sys/devices/platform/soc/9140a000.pwm/pwm/pwmchip0\n2\u3001echo 4 > export          \u5bfc\u51fa\u901a\u90534 \u5373PWM4\uff1b\n3\u3001cd pwm4/                 \u51fa\u73b0pwm4\u7684\u76ee\u5f55\uff0c\u8fdb\u5165\uff1b\n4\u3001echo 100000 > period     \u8bbe\u7f6e\u5468\u671f 100us\uff0c\n5\u3001echo 50000 > duty_cycle  \u8bbe\u7f6e\u6b63\u5360\u7a7a\u6bd4\u5468\u671f 50us\uff0c\n6\u3001echo 1 >enable           \u5f53\u524d\u901a\u9053\u4f7f\u80fd\uff1b\n\n"})}),"\n",(0,d.jsx)(n.h4,{id:"2102-\u7528\u6237\u6001\u8bbf\u95ee-pwm",children:"2.10.2 \u7528\u6237\u6001\u8bbf\u95ee PWM"}),"\n",(0,d.jsx)(n.p,{children:"\u7565\u3002"}),"\n",(0,d.jsx)(n.h3,{id:"211-open",children:"2.11 open"}),"\n",(0,d.jsx)(n.p,{children:"\u3010\u63cf\u8ff0\u3011"}),"\n",(0,d.jsx)(n.p,{children:"\u6253\u5f00\u8bbe\u5907\u8282\u70b9\u3002"}),"\n",(0,d.jsx)(n.p,{children:"\u3010\u8bed\u6cd5\u3011"}),"\n",(0,d.jsx)(n.p,{children:(0,d.jsx)(n.code,{children:"int open(const char *pathname, int flags)"})}),"\n",(0,d.jsx)(n.p,{children:"\u3010\u53c2\u6570\u3011"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"\u53c2\u6570\u540d\u79f0"}),(0,d.jsx)(n.th,{children:"\u63cf\u8ff0"}),(0,d.jsx)(n.th,{children:"\u8f93\u5165/\u8f93\u51fa"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"patchname"}),(0,d.jsx)(n.td,{children:"\u5168\u8def\u5f84\u8bbe\u5907\u540d"}),(0,d.jsx)(n.td,{children:"\u8f93\u5165"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"flags"}),(0,d.jsx)(n.td,{children:"\u6253\u5f00\u65b9\u5f0f"}),(0,d.jsx)(n.td,{children:"\u8f93\u5165"})]})]})]}),"\n",(0,d.jsx)(n.p,{children:"\u3010\u8fd4\u56de\u503c\u3011"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"\u8fd4\u56de\u503c"}),(0,d.jsx)(n.th,{children:"\u63cf\u8ff0"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"\u8d1f\u503c"}),(0,d.jsx)(n.td,{children:"\u9519\u8bef"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"\u6b63\u503c"}),(0,d.jsx)(n.td,{children:"\u6253\u5f00\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26id"})]})]})]}),"\n",(0,d.jsx)(n.p,{children:"\u3010\u9700\u6c42\u3011"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:["\u5934\u6587\u4ef6\uff1a",(0,d.jsx)(n.code,{children:"sys/types.h"}),", ",(0,d.jsx)(n.code,{children:"sys/stat.h"}),", ",(0,d.jsx)(n.code,{children:"fcntl.h"})]}),"\n"]}),"\n",(0,d.jsx)(n.p,{children:"\u3010\u6ce8\u610f\u3011"}),"\n",(0,d.jsx)(n.p,{children:"\u65e0"}),"\n",(0,d.jsx)(n.p,{children:"\u3010\u4e3e\u4f8b\u3011"}),"\n",(0,d.jsx)(n.p,{children:(0,d.jsx)(n.code,{children:'int fd = open("/dev/i2c-0", O_RDWR);'})}),"\n",(0,d.jsx)(n.h3,{id:"212-ioctl",children:"2.12 ioctl"}),"\n",(0,d.jsx)(n.p,{children:"\u3010\u63cf\u8ff0\u3011"}),"\n",(0,d.jsx)(n.p,{children:"\u8bbe\u5907\u63a7\u5236\u3002"}),"\n",(0,d.jsx)(n.p,{children:"\u3010\u8bed\u6cd5\u3011"}),"\n",(0,d.jsx)(n.p,{children:(0,d.jsx)(n.code,{children:"int ioctl(int fd, unsigned long request, ...);"})}),"\n",(0,d.jsx)(n.p,{children:"\u3010\u53c2\u6570\u3011"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"\u53c2\u6570\u540d\u79f0"}),(0,d.jsx)(n.th,{children:"\u63cf\u8ff0"}),(0,d.jsx)(n.th,{children:"\u8f93\u5165/\u8f93\u51fa"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"fd"}),(0,d.jsx)(n.td,{children:"\u6253\u5f00\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26"}),(0,d.jsx)(n.td,{children:"\u8f93\u5165"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"request"}),(0,d.jsx)(n.td,{children:"32\u4f4d\u547d\u4ee4\u7801"}),(0,d.jsx)(n.td,{children:"--"})]})]})]}),"\n",(0,d.jsxs)(n.p,{children:["\u547d\u4ee4\u7801\u8bf7\u53c2\u8003",(0,d.jsx)(n.code,{children:"include/uapi/asm-generic/ioctl.h"})]}),"\n",(0,d.jsx)(n.p,{children:"\u3010\u8fd4\u56de\u503c\u3011"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"\u8fd4\u56de\u503c"}),(0,d.jsx)(n.th,{children:"\u63cf\u8ff0"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"\u8d1f\u503c"}),(0,d.jsx)(n.td,{children:"\u9519\u8bef"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"\u975e\u8d1f\u503c"}),(0,d.jsx)(n.td,{children:"\u6210\u529f"})]})]})]}),"\n",(0,d.jsx)(n.p,{children:"\u3010\u9700\u6c42\u3011"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:["\u5934\u6587\u4ef6\uff1a",(0,d.jsx)(n.code,{children:"sys/ioctl.h"})]}),"\n"]}),"\n",(0,d.jsx)(n.p,{children:"\u3010\u6ce8\u610f\u3011"}),"\n",(0,d.jsx)(n.p,{children:"\u65e0"}),"\n",(0,d.jsx)(n.p,{children:"\u3010\u4e3e\u4f8b\u3011"}),"\n",(0,d.jsx)(n.p,{children:(0,d.jsx)(n.code,{children:"err = ioctl(file, I2C_SMBUS, &args);"})}),"\n",(0,d.jsx)(n.h3,{id:"213-read",children:"2.13 read"}),"\n",(0,d.jsx)(n.p,{children:"\u3010\u63cf\u8ff0\u3011"}),"\n",(0,d.jsx)(n.p,{children:"\u8bfb\u53d6\u6253\u5f00\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u5185\u5bb9\u3002"}),"\n",(0,d.jsx)(n.p,{children:"\u3010\u8bed\u6cd5\u3011"}),"\n",(0,d.jsx)(n.p,{children:(0,d.jsx)(n.code,{children:"ssize_t read(int fd, void *buf, size_t count);"})}),"\n",(0,d.jsx)(n.p,{children:"\u3010\u53c2\u6570\u3011"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"\u53c2\u6570\u540d\u79f0"}),(0,d.jsx)(n.th,{children:"\u63cf\u8ff0"}),(0,d.jsx)(n.th,{children:"\u8f93\u5165/\u8f93\u51fa"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"fd"}),(0,d.jsx)(n.td,{children:"\u6253\u5f00\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26"}),(0,d.jsx)(n.td,{children:"\u8f93\u5165"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"buf"}),(0,d.jsx)(n.td,{children:"\u5b58\u653e\u8f93\u51fa\u6570\u636e\u7684\u7a7a\u95f4"}),(0,d.jsx)(n.td,{children:"\u8f93\u51fa"})]})]})]}),"\n",(0,d.jsx)(n.p,{children:"\u3010\u8fd4\u56de\u503c\u3011"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"\u8fd4\u56de\u503c"}),(0,d.jsx)(n.th,{children:"\u63cf\u8ff0"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"-1"}),(0,d.jsx)(n.td,{children:"\u9519\u8bef"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"\u975e\u8d1f\u503c"}),(0,d.jsx)(n.td,{children:"\u8bfb\u53d6\u5230\u7684\u5b57\u8282\u6570"})]})]})]}),"\n",(0,d.jsx)(n.p,{children:"\u3010\u9700\u6c42\u3011"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:["\u5934\u6587\u4ef6\uff1a",(0,d.jsx)(n.code,{children:"unistd.h"})]}),"\n"]}),"\n",(0,d.jsx)(n.p,{children:"\u3010\u6ce8\u610f\u3011"}),"\n",(0,d.jsx)(n.p,{children:"\u65e0"}),"\n",(0,d.jsx)(n.p,{children:"\u3010\u4e3e\u4f8b\u3011"}),"\n",(0,d.jsx)(n.p,{children:(0,d.jsx)(n.code,{children:"int n = read(fd, &buf, num);"})}),"\n",(0,d.jsx)(n.h3,{id:"214-write",children:"2.14 write"}),"\n",(0,d.jsx)(n.p,{children:"\u3010\u63cf\u8ff0\u3011"}),"\n",(0,d.jsx)(n.p,{children:"\u5411\u6253\u5f00\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u5199\u6570\u636e\u3002"}),"\n",(0,d.jsx)(n.p,{children:"\u3010\u8bed\u6cd5\u3011"}),"\n",(0,d.jsx)(n.p,{children:(0,d.jsx)(n.code,{children:"ssize_t write(int fd, const void *buf, size_t count);"})}),"\n",(0,d.jsx)(n.p,{children:"\u3010\u53c2\u6570\u3011"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"\u53c2\u6570\u540d\u79f0"}),(0,d.jsx)(n.th,{children:"\u63cf\u8ff0"}),(0,d.jsx)(n.th,{children:"\u8f93\u5165/\u8f93\u51fa"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"fd"}),(0,d.jsx)(n.td,{children:"\u6253\u5f00\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26"}),(0,d.jsx)(n.td,{children:"\u8f93\u5165"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"buf"}),(0,d.jsx)(n.td,{children:"\u5b58\u653e\u6570\u636e\u7684\u7a7a\u95f4"}),(0,d.jsx)(n.td,{children:"\u8f93\u51fa"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"count"}),(0,d.jsx)(n.td,{children:"\u9700\u8981\u5199\u5165\u7684\u957f\u5ea6"}),(0,d.jsx)(n.td,{children:"\u8f93\u5165"})]})]})]}),"\n",(0,d.jsx)(n.p,{children:"\u3010\u8fd4\u56de\u503c\u3011"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"\u8fd4\u56de\u503c"}),(0,d.jsx)(n.th,{children:"\u63cf\u8ff0"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"-1"}),(0,d.jsx)(n.td,{children:"\u9519\u8bef"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"0"}),(0,d.jsx)(n.td,{children:"\u672a\u5199\u5165"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"\u6b63\u503c"}),(0,d.jsx)(n.td,{children:"\u5199\u5165\u7684\u5b57\u8282\u6570"})]})]})]}),"\n",(0,d.jsx)(n.p,{children:"\u3010\u9700\u6c42\u3011"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:["\u5934\u6587\u4ef6\uff1a",(0,d.jsx)(n.code,{children:"unistd.h"})]}),"\n"]}),"\n",(0,d.jsx)(n.p,{children:"\u3010\u6ce8\u610f\u3011"}),"\n",(0,d.jsx)(n.p,{children:"\u65e0"}),"\n",(0,d.jsx)(n.p,{children:"\u3010\u4e3e\u4f8b\u3011"}),"\n",(0,d.jsx)(n.p,{children:(0,d.jsx)(n.code,{children:"int n = write(fd, &buf, num);"})})]})}function h(e={}){const{wrapper:n}={...(0,f.R)(),...e.components};return n?(0,d.jsx)(n,{...e,children:(0,d.jsx)(a,{...e})}):a(e)}},32672:(e,n,s)=>{s.d(n,{A:()=>d});const d=s.p+"assets/images/otp_linux-ddb0d470d32d3698cf766af9f4d4845e.png"},70426:(e,n,s)=>{s.d(n,{A:()=>d});const d=s.p+"assets/images/trng_linux-11da0e7d3cb4f44052173f4595da582a.png"},90570:(e,n,s)=>{s.d(n,{A:()=>d});const d=s.p+"assets/images/ts_linux-bf1609db0c054a5ba8d9ce1ad28527d3.png"},28453:(e,n,s)=>{s.d(n,{R:()=>i,x:()=>l});var d=s(96540);const f={},c=d.createContext(f);function i(e){const n=d.useContext(c);return d.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(f):e.components||f:i(e.components),d.createElement(c.Provider,{value:n},e.children)}}}]);